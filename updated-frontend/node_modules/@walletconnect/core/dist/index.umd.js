(function(q,ot){typeof exports=="object"&&typeof module<"u"?ot(exports):typeof define=="function"&&define.amd?define(["exports"],ot):(q=typeof globalThis<"u"?globalThis:q||self,ot(q["@walletconnect/core"]={}))})(this,function(q){"use strict";var ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var ht={exports:{}},Vt=typeof Reflect=="object"?Reflect:null,li=Vt&&typeof Vt.apply=="function"?Vt.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Dr;Vt&&typeof Vt.ownKeys=="function"?Dr=Vt.ownKeys:Object.getOwnPropertySymbols?Dr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Dr=function(e){return Object.getOwnPropertyNames(e)};function Na(t){console&&console.warn&&console.warn(t)}var di=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}ht.exports=Oe,ht.exports.once=ja,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var gi=10;function Sr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return gi},set:function(t){if(typeof t!="number"||t<0||di(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");gi=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||di(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function yi(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return yi(this)},Oe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var f;if(r.length>0&&(f=r[0]),f instanceof Error)throw f;var u=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw u.context=f,u}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")li(h,this,r);else for(var c=h.length,l=wi(h,c),n=0;n<c;++n)li(l[n],this,r);return!0};function _i(t,e,r,n){var i,s,f;if(Sr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),f=s[e]),f===void 0)f=s[e]=r,++t._eventsCount;else if(typeof f=="function"?f=s[e]=n?[r,f]:[f,r]:n?f.unshift(r):f.push(r),i=yi(t),i>0&&f.length>i&&!f.warned){f.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=f.length,Na(u)}return t}Oe.prototype.addListener=function(e,r){return _i(this,e,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(e,r){return _i(this,e,r,!0)};function Ua(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function pi(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Ua.bind(n);return i.listener=r,n.wrapFn=i,i}Oe.prototype.once=function(e,r){return Sr(r),this.on(e,pi(this,e,r)),this},Oe.prototype.prependOnceListener=function(e,r){return Sr(r),this.prependListener(e,pi(this,e,r)),this},Oe.prototype.removeListener=function(e,r){var n,i,s,f,u;if(Sr(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,f=n.length-1;f>=0;f--)if(n[f]===r||n[f].listener===r){u=n[f].listener,s=f;break}if(s<0)return this;s===0?n.shift():Ma(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,u||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),f;for(i=0;i<s.length;++i)f=s[i],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function bi(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?$a(i):wi(i,i.length)}Oe.prototype.listeners=function(e){return bi(this,e,!0)},Oe.prototype.rawListeners=function(e){return bi(this,e,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):vi.call(t,e)},Oe.prototype.listenerCount=vi;function vi(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Dr(this._events):[]};function wi(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Ma(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function $a(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function ja(t,e){return new Promise(function(r,n){function i(f){t.removeListener(e,s),n(f)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Ei(t,e,s,{once:!0}),e!=="error"&&Fa(t,i,{once:!0})})}function Fa(t,e,r){typeof t.on=="function"&&Ei(t,"error",e,r)}function Ei(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const Ba=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,za=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Ka=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Ha(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Ga(t);return}return e}function Ga(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function Or(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.at(-1)==='"'&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!Ka.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(Ba.test(t)||za.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,Ha)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}function Va(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Ke(t,...e){try{return Va(t(...e))}catch(r){return Promise.reject(r)}}function Wa(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function Ya(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Ir(t){if(Wa(t))return String(t);if(Ya(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Ir(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function mi(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const on="base64:";function qa(t){if(typeof t=="string")return t;mi();const e=Buffer.from(t).toString("base64");return on+e}function ka(t){return typeof t!="string"||!t.startsWith(on)?t:(mi(),Buffer.from(t.slice(on.length),"base64"))}function at(t){return t?t.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Xa(...t){return at(t.join(":"))}function Tr(t){return t=at(t),t?t+":":""}function K0(t){return t}const Ja="memory",Qa=()=>{const t=new Map;return{name:Ja,options:{},hasItem(e){return t.has(e)},getItem(e){return t.get(e)||null},getItemRaw(e){return t.get(e)||null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return Array.from(t.keys())},clear(){t.clear()},dispose(){t.clear()}}};function Za(t={}){const e={mounts:{"":t.driver||Qa()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=c=>{for(const l of e.mountpoints)if(c.startsWith(l))return{base:l,relativeKey:c.slice(l.length),driver:e.mounts[l]};return{base:"",relativeKey:c,driver:e.mounts[""]}},n=(c,l)=>e.mountpoints.filter(p=>p.startsWith(c)||l&&c.startsWith(p)).map(p=>({relativeBase:c.length>p.length?c.slice(p.length):void 0,mountpoint:p,driver:e.mounts[p]})),i=(c,l)=>{if(e.watching){l=at(l);for(const p of e.watchListeners)p(c,l)}},s=async()=>{if(!e.watching){e.watching=!0;for(const c in e.mounts)e.unwatch[c]=await Di(e.mounts[c],i,c)}},f=async()=>{if(e.watching){for(const c in e.unwatch)await e.unwatch[c]();e.unwatch={},e.watching=!1}},u=(c,l,p)=>{const _=new Map,b=O=>{let A=_.get(O.base);return A||(A={driver:O.driver,base:O.base,items:[]},_.set(O.base,A)),A};for(const O of c){const A=typeof O=="string",N=at(A?O:O.key),G=A?void 0:O.value,m=A||!O.options?l:{...l,...O.options},R=r(N);b(R).items.push({key:N,value:G,relativeKey:R.relativeKey,options:m})}return Promise.all([..._.values()].map(O=>p(O))).then(O=>O.flat())},h={hasItem(c,l={}){c=at(c);const{relativeKey:p,driver:_}=r(c);return Ke(_.hasItem,p,l)},getItem(c,l={}){c=at(c);const{relativeKey:p,driver:_}=r(c);return Ke(_.getItem,p,l).then(b=>Or(b))},getItems(c,l){return u(c,l,p=>p.driver.getItems?Ke(p.driver.getItems,p.items.map(_=>({key:_.relativeKey,options:_.options})),l).then(_=>_.map(b=>({key:Xa(p.base,b.key),value:Or(b.value)}))):Promise.all(p.items.map(_=>Ke(p.driver.getItem,_.relativeKey,_.options).then(b=>({key:_.key,value:Or(b)})))))},getItemRaw(c,l={}){c=at(c);const{relativeKey:p,driver:_}=r(c);return _.getItemRaw?Ke(_.getItemRaw,p,l):Ke(_.getItem,p,l).then(b=>ka(b))},async setItem(c,l,p={}){if(l===void 0)return h.removeItem(c);c=at(c);const{relativeKey:_,driver:b}=r(c);b.setItem&&(await Ke(b.setItem,_,Ir(l),p),b.watch||i("update",c))},async setItems(c,l){await u(c,l,async p=>{p.driver.setItems&&await Ke(p.driver.setItems,p.items.map(_=>({key:_.relativeKey,value:Ir(_.value),options:_.options})),l),p.driver.setItem&&await Promise.all(p.items.map(_=>Ke(p.driver.setItem,_.relativeKey,Ir(_.value),_.options)))})},async setItemRaw(c,l,p={}){if(l===void 0)return h.removeItem(c,p);c=at(c);const{relativeKey:_,driver:b}=r(c);if(b.setItemRaw)await Ke(b.setItemRaw,_,l,p);else if(b.setItem)await Ke(b.setItem,_,qa(l),p);else return;b.watch||i("update",c)},async removeItem(c,l={}){typeof l=="boolean"&&(l={removeMeta:l}),c=at(c);const{relativeKey:p,driver:_}=r(c);_.removeItem&&(await Ke(_.removeItem,p,l),(l.removeMeta||l.removeMata)&&await Ke(_.removeItem,p+"$",l),_.watch||i("remove",c))},async getMeta(c,l={}){typeof l=="boolean"&&(l={nativeOnly:l}),c=at(c);const{relativeKey:p,driver:_}=r(c),b=Object.create(null);if(_.getMeta&&Object.assign(b,await Ke(_.getMeta,p,l)),!l.nativeOnly){const O=await Ke(_.getItem,p+"$",l).then(A=>Or(A));O&&typeof O=="object"&&(typeof O.atime=="string"&&(O.atime=new Date(O.atime)),typeof O.mtime=="string"&&(O.mtime=new Date(O.mtime)),Object.assign(b,O))}return b},setMeta(c,l,p={}){return this.setItem(c+"$",l,p)},removeMeta(c,l={}){return this.removeItem(c+"$",l)},async getKeys(c,l={}){c=Tr(c);const p=n(c,!0);let _=[];const b=[];for(const O of p){const N=(await Ke(O.driver.getKeys,O.relativeBase,l)).map(G=>O.mountpoint+at(G)).filter(G=>!_.some(m=>G.startsWith(m)));b.push(...N),_=[O.mountpoint,..._.filter(G=>!G.startsWith(O.mountpoint))]}return c?b.filter(O=>O.startsWith(c)&&!O.endsWith("$")):b.filter(O=>!O.endsWith("$"))},async clear(c,l={}){c=Tr(c),await Promise.all(n(c,!1).map(async p=>{if(p.driver.clear)return Ke(p.driver.clear,p.relativeBase,l);if(p.driver.removeItem){const _=await p.driver.getKeys(p.relativeBase||"",l);return Promise.all(_.map(b=>p.driver.removeItem(b,l)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(c=>Si(c)))},async watch(c){return await s(),e.watchListeners.push(c),async()=>{e.watchListeners=e.watchListeners.filter(l=>l!==c),e.watchListeners.length===0&&await f()}},async unwatch(){e.watchListeners=[],await f()},mount(c,l){if(c=Tr(c),c&&e.mounts[c])throw new Error(`already mounted at ${c}`);return c&&(e.mountpoints.push(c),e.mountpoints.sort((p,_)=>_.length-p.length)),e.mounts[c]=l,e.watching&&Promise.resolve(Di(l,i,c)).then(p=>{e.unwatch[c]=p}).catch(console.error),h},async unmount(c,l=!0){c=Tr(c),!(!c||!e.mounts[c])&&(e.watching&&c in e.unwatch&&(e.unwatch[c](),delete e.unwatch[c]),l&&await Si(e.mounts[c]),e.mountpoints=e.mountpoints.filter(p=>p!==c),delete e.mounts[c])},getMount(c=""){c=at(c)+":";const l=r(c);return{driver:l.driver,base:l.base}},getMounts(c="",l={}){return c=at(c),n(c,l.parents).map(_=>({driver:_.driver,base:_.mountpoint}))}};return h}function Di(t,e,r){return t.watch?t.watch((n,i)=>e(n,r+i)):()=>{}}async function Si(t){typeof t.dispose=="function"&&await Ke(t.dispose)}function Lt(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function Oi(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const n=Lt(r);return(i,s)=>n.then(f=>s(f.transaction(e,i).objectStore(e)))}let an;function tr(){return an||(an=Oi("keyval-store","keyval")),an}function Ii(t,e=tr()){return e("readonly",r=>Lt(r.get(t)))}function ec(t,e,r=tr()){return r("readwrite",n=>(n.put(e,t),Lt(n.transaction)))}function tc(t,e=tr()){return e("readwrite",r=>(r.delete(t),Lt(r.transaction)))}function rc(t=tr()){return t("readwrite",e=>(e.clear(),Lt(e.transaction)))}function nc(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Lt(t.transaction)}function ic(t=tr()){return t("readonly",e=>{if(e.getAllKeys)return Lt(e.getAllKeys());const r=[];return nc(e,n=>r.push(n.key)).then(()=>r)})}const sc=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),oc=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function xr(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return oc(t)}catch{return t}}function rr(t){return typeof t=="string"?t:sc(t)||""}const ac="idb-keyval";var cc=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=i=>e+i;let n;return t.dbName&&t.storeName&&(n=Oi(t.dbName,t.storeName)),{name:ac,options:t,async hasItem(i){return!(typeof await Ii(r(i),n)>"u")},async getItem(i){return await Ii(r(i),n)??null},setItem(i,s){return ec(r(i),s,n)},removeItem(i){return tc(r(i),n)},getKeys(){return ic(n)},clear(){return rc(n)}}};const uc="WALLET_CONNECT_V2_INDEXED_DB",fc="keyvaluestorage";class hc{constructor(){this.indexedDb=Za({driver:cc({dbName:uc,storeName:fc})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,rr(r))}async removeItem(e){await this.indexedDb.removeItem(e)}}var cn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Rr={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof cn<"u"&&cn.localStorage?Rr.exports=cn.localStorage:typeof window<"u"&&window.localStorage?Rr.exports=window.localStorage:Rr.exports=new e})();function lc(t){var e;return[t[0],xr((e=t[1])!=null?e:"")]}class dc{constructor(){this.localStorage=Rr.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(lc)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return xr(r)}async setItem(e,r){this.localStorage.setItem(e,rr(r))}async removeItem(e){this.localStorage.removeItem(e)}}const gc="wc_storage_version",Ti=1,yc=async(t,e,r)=>{const n=gc,i=await e.getItem(n);if(i&&i>=Ti){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const f=[];for(;s.length;){const u=s.shift();if(!u)continue;const h=u.toLowerCase();if(h.includes("wc@")||h.includes("walletconnect")||h.includes("wc_")||h.includes("wallet_connect")){const c=await t.getItem(u);await e.setItem(u,c),f.push(u)}}await e.setItem(n,Ti),r(e),_c(t,f)},_c=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};class pc{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new dc;this.storage=e;try{const r=new hc;yc(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}}var Wt={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var un=function(t,e){return un=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},un(t,e)};function bc(t,e){un(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var fn=function(){return fn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},fn.apply(this,arguments)};function vc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function wc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(f=t[u])&&(s=(i<3?f(s):i>3?f(e,r,s):f(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Ec(t,e){return function(r,n){e(r,n,t)}}function mc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Dc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(f){f(s)})}return new(r||(r=Promise))(function(s,f){function u(l){try{c(n.next(l))}catch(p){f(p)}}function h(l){try{c(n.throw(l))}catch(p){f(p)}}function c(l){l.done?s(l.value):i(l.value).then(u,h)}c((n=n.apply(t,e||[])).next())})}function Sc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(c){return function(l){return h([c,l])}}function h(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){r.label=c[1];break}if(c[0]===6&&r.label<s[1]){r.label=s[1],s=c;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(c);break}s[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(l){c=[6,l],i=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Oc(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Ic(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function hn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xi(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],f;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){f={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return s}function Tc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(xi(arguments[e]));return t}function xc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],f=0,u=s.length;f<u;f++,i++)n[i]=s[f];return n}function nr(t){return this instanceof nr?(this.v=t,this):new nr(t)}function Rc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},f("next"),f("throw"),f("return"),i[Symbol.asyncIterator]=function(){return this},i;function f(_){n[_]&&(i[_]=function(b){return new Promise(function(O,A){s.push([_,b,O,A])>1||u(_,b)})})}function u(_,b){try{h(n[_](b))}catch(O){p(s[0][3],O)}}function h(_){_.value instanceof nr?Promise.resolve(_.value.v).then(c,l):p(s[0][2],_)}function c(_){u("next",_)}function l(_){u("throw",_)}function p(_,b){_(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Cc(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(f){return(r=!r)?{value:nr(t[i](f)),done:i==="return"}:s?s(f):f}:s}}function Ac(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof hn=="function"?hn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(f){return new Promise(function(u,h){f=t[s](f),i(u,h,f.done,f.value)})}}function i(s,f,u,h){Promise.resolve(h).then(function(c){s({value:c,done:u})},f)}}function Pc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Lc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Nc(t){return t&&t.__esModule?t:{default:t}}function Uc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Mc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var $c=Object.freeze({__proto__:null,__extends:bc,get __assign(){return fn},__rest:vc,__decorate:wc,__param:Ec,__metadata:mc,__awaiter:Dc,__generator:Sc,__createBinding:Oc,__exportStar:Ic,__values:hn,__read:xi,__spread:Tc,__spreadArrays:xc,__await:nr,__asyncGenerator:Rc,__asyncDelegator:Cc,__asyncValues:Ac,__makeTemplateObject:Pc,__importStar:Lc,__importDefault:Nc,__classPrivateFieldGet:Uc,__classPrivateFieldSet:Mc}),Cr=Gt($c),ir={},ce={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ln=function(t,e){return ln=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ln(t,e)};function jc(t,e){ln(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var dn=function(){return dn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},dn.apply(this,arguments)};function Fc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Bc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(f=t[u])&&(s=(i<3?f(s):i>3?f(e,r,s):f(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function zc(t,e){return function(r,n){e(r,n,t)}}function Kc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Hc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(f){f(s)})}return new(r||(r=Promise))(function(s,f){function u(l){try{c(n.next(l))}catch(p){f(p)}}function h(l){try{c(n.throw(l))}catch(p){f(p)}}function c(l){l.done?s(l.value):i(l.value).then(u,h)}c((n=n.apply(t,e||[])).next())})}function Gc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(c){return function(l){return h([c,l])}}function h(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){r.label=c[1];break}if(c[0]===6&&r.label<s[1]){r.label=s[1],s=c;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(c);break}s[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(l){c=[6,l],i=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Vc(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Wc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function gn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ri(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],f;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){f={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return s}function Yc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ri(arguments[e]));return t}function qc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],f=0,u=s.length;f<u;f++,i++)n[i]=s[f];return n}function sr(t){return this instanceof sr?(this.v=t,this):new sr(t)}function kc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},f("next"),f("throw"),f("return"),i[Symbol.asyncIterator]=function(){return this},i;function f(_){n[_]&&(i[_]=function(b){return new Promise(function(O,A){s.push([_,b,O,A])>1||u(_,b)})})}function u(_,b){try{h(n[_](b))}catch(O){p(s[0][3],O)}}function h(_){_.value instanceof sr?Promise.resolve(_.value.v).then(c,l):p(s[0][2],_)}function c(_){u("next",_)}function l(_){u("throw",_)}function p(_,b){_(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Xc(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(f){return(r=!r)?{value:sr(t[i](f)),done:i==="return"}:s?s(f):f}:s}}function Jc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof gn=="function"?gn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(f){return new Promise(function(u,h){f=t[s](f),i(u,h,f.done,f.value)})}}function i(s,f,u,h){Promise.resolve(h).then(function(c){s({value:c,done:u})},f)}}function Qc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Zc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function eu(t){return t&&t.__esModule?t:{default:t}}function tu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function ru(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var nu=Object.freeze({__proto__:null,__extends:jc,get __assign(){return dn},__rest:Fc,__decorate:Bc,__param:zc,__metadata:Kc,__awaiter:Hc,__generator:Gc,__createBinding:Vc,__exportStar:Wc,__values:gn,__read:Ri,__spread:Yc,__spreadArrays:qc,__await:sr,__asyncGenerator:kc,__asyncDelegator:Xc,__asyncValues:Jc,__makeTemplateObject:Qc,__importStar:Zc,__importDefault:eu,__classPrivateFieldGet:tu,__classPrivateFieldSet:ru}),Ar=Gt(nu),yn={},or={},Ci;function iu(){if(Ci)return or;Ci=1,Object.defineProperty(or,"__esModule",{value:!0}),or.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return or.delay=t,or}var Nt={},_n={},Ut={},Ai;function su(){return Ai||(Ai=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.ONE_THOUSAND=Ut.ONE_HUNDRED=void 0,Ut.ONE_HUNDRED=100,Ut.ONE_THOUSAND=1e3),Ut}var pn={},Pi;function ou(){return Pi||(Pi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(pn)),pn}var Li;function Ni(){return Li||(Li=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ar;e.__exportStar(su(),t),e.__exportStar(ou(),t)}(_n)),_n}var Ui;function au(){if(Ui)return Nt;Ui=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.fromMiliseconds=Nt.toMiliseconds=void 0;const t=Ni();function e(n){return n*t.ONE_THOUSAND}Nt.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Nt.fromMiliseconds=r,Nt}var Mi;function cu(){return Mi||(Mi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ar;e.__exportStar(iu(),t),e.__exportStar(au(),t)}(yn)),yn}var Yt={},$i;function uu(){if($i)return Yt;$i=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Yt.Watch=t,Yt.default=t,Yt}var bn={},ar={},ji;function fu(){if(ji)return ar;ji=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.IWatch=void 0;class t{}return ar.IWatch=t,ar}var Fi;function hu(){return Fi||(Fi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Ar.__exportStar(fu(),t)}(bn)),bn}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ar;e.__exportStar(cu(),t),e.__exportStar(uu(),t),e.__exportStar(hu(),t),e.__exportStar(Ni(),t)})(ce);var vn={},cr={};class Mt{}var lu=Object.freeze({__proto__:null,IEvents:Mt}),du=Gt(lu),Bi;function gu(){if(Bi)return cr;Bi=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.IHeartBeat=void 0;const t=du;class e extends t.IEvents{constructor(n){super()}}return cr.IHeartBeat=e,cr}var zi;function Ki(){return zi||(zi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Cr.__exportStar(gu(),t)}(vn)),vn}var wn={},$t={},Hi;function yu(){if(Hi)return $t;Hi=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.HEARTBEAT_EVENTS=$t.HEARTBEAT_INTERVAL=void 0;const t=ce;return $t.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,$t.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},$t}var Gi;function Vi(){return Gi||(Gi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Cr.__exportStar(yu(),t)}(wn)),wn}var Wi;function _u(){if(Wi)return ir;Wi=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.HeartBeat=void 0;const t=Cr,e=ht.exports,r=ce,n=Ki(),i=Vi();class s extends n.IHeartBeat{constructor(u){super(u),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=u?.interval||i.HEARTBEAT_INTERVAL}static init(u){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(u);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,h){this.events.on(u,h)}once(u,h){this.events.once(u,h)}off(u,h){this.events.off(u,h)}removeListener(u,h){this.events.removeListener(u,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return ir.HeartBeat=s,ir}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cr;e.__exportStar(_u(),t),e.__exportStar(Ki(),t),e.__exportStar(Vi(),t)})(Wt);var Se={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var En=function(t,e){return En=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},En(t,e)};function pu(t,e){En(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var mn=function(){return mn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},mn.apply(this,arguments)};function bu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function vu(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(f=t[u])&&(s=(i<3?f(s):i>3?f(e,r,s):f(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function wu(t,e){return function(r,n){e(r,n,t)}}function Eu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function mu(t,e,r,n){function i(s){return s instanceof r?s:new r(function(f){f(s)})}return new(r||(r=Promise))(function(s,f){function u(l){try{c(n.next(l))}catch(p){f(p)}}function h(l){try{c(n.throw(l))}catch(p){f(p)}}function c(l){l.done?s(l.value):i(l.value).then(u,h)}c((n=n.apply(t,e||[])).next())})}function Du(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(c){return function(l){return h([c,l])}}function h(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){r.label=c[1];break}if(c[0]===6&&r.label<s[1]){r.label=s[1],s=c;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(c);break}s[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(l){c=[6,l],i=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Su(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Ou(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Dn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yi(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],f;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){f={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return s}function Iu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Yi(arguments[e]));return t}function Tu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],f=0,u=s.length;f<u;f++,i++)n[i]=s[f];return n}function ur(t){return this instanceof ur?(this.v=t,this):new ur(t)}function xu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},f("next"),f("throw"),f("return"),i[Symbol.asyncIterator]=function(){return this},i;function f(_){n[_]&&(i[_]=function(b){return new Promise(function(O,A){s.push([_,b,O,A])>1||u(_,b)})})}function u(_,b){try{h(n[_](b))}catch(O){p(s[0][3],O)}}function h(_){_.value instanceof ur?Promise.resolve(_.value.v).then(c,l):p(s[0][2],_)}function c(_){u("next",_)}function l(_){u("throw",_)}function p(_,b){_(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Ru(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(f){return(r=!r)?{value:ur(t[i](f)),done:i==="return"}:s?s(f):f}:s}}function Cu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Dn=="function"?Dn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(f){return new Promise(function(u,h){f=t[s](f),i(u,h,f.done,f.value)})}}function i(s,f,u,h){Promise.resolve(h).then(function(c){s({value:c,done:u})},f)}}function Au(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Pu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Lu(t){return t&&t.__esModule?t:{default:t}}function Nu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Uu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Mu=Object.freeze({__proto__:null,__extends:pu,get __assign(){return mn},__rest:bu,__decorate:vu,__param:wu,__metadata:Eu,__awaiter:mu,__generator:Du,__createBinding:Su,__exportStar:Ou,__values:Dn,__read:Yi,__spread:Iu,__spreadArrays:Tu,__await:ur,__asyncGenerator:xu,__asyncDelegator:Ru,__asyncValues:Cu,__makeTemplateObject:Au,__importStar:Pu,__importDefault:Lu,__classPrivateFieldGet:Nu,__classPrivateFieldSet:Uu}),$u=Gt(Mu),Sn,qi;function ju(){if(qi)return Sn;qi=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Sn=e;function e(r,n,i){var s=i&&i.stringify||t,f=1;if(typeof r=="object"&&r!==null){var u=n.length+f;if(u===1)return r;var h=new Array(u);h[0]=s(r);for(var c=1;c<u;c++)h[c]=s(n[c]);return h.join(" ")}if(typeof r!="string")return r;var l=n.length;if(l===0)return r;for(var p="",_=1-f,b=-1,O=r&&r.length||0,A=0;A<O;){if(r.charCodeAt(A)===37&&A+1<O){switch(b=b>-1?b:0,r.charCodeAt(A+1)){case 100:case 102:if(_>=l||n[_]==null)break;b<A&&(p+=r.slice(b,A)),p+=Number(n[_]),b=A+2,A++;break;case 105:if(_>=l||n[_]==null)break;b<A&&(p+=r.slice(b,A)),p+=Math.floor(Number(n[_])),b=A+2,A++;break;case 79:case 111:case 106:if(_>=l||n[_]===void 0)break;b<A&&(p+=r.slice(b,A));var N=typeof n[_];if(N==="string"){p+="'"+n[_]+"'",b=A+2,A++;break}if(N==="function"){p+=n[_].name||"<anonymous>",b=A+2,A++;break}p+=s(n[_]),b=A+2,A++;break;case 115:if(_>=l)break;b<A&&(p+=r.slice(b,A)),p+=String(n[_]),b=A+2,A++;break;case 37:b<A&&(p+=r.slice(b,A)),p+="%",b=A+2,A++,_--;break}++_}++A}return b===-1?r:(b<O&&(p+=r.slice(b)),p)}return Sn}var On,ki;function Fu(){if(ki)return On;ki=1;const t=ju();On=i;const e=E().console||{},r={mapHttpRequest:O,mapHttpResponse:O,wrapRequestSerializer:A,wrapResponseSerializer:A,wrapErrorSerializer:A,req:O,res:O,err:_};function n(g,o){return Array.isArray(g)?g.filter(function(L){return L!=="!stdSerializers.err"}):g===!0?Object.keys(o):!1}function i(g){g=g||{},g.browser=g.browser||{};const o=g.browser.transmit;if(o&&typeof o.send!="function")throw Error("pino: transmit option must have a send function");const d=g.browser.write||e;g.browser.write&&(g.browser.asObject=!0);const L=g.serializers||{},P=n(g.browser.serialize,L);let K=g.browser.serialize;Array.isArray(g.browser.serialize)&&g.browser.serialize.indexOf("!stdSerializers.err")>-1&&(K=!1);const V=["error","fatal","warn","info","debug","trace"];typeof d=="function"&&(d.error=d.fatal=d.warn=d.info=d.debug=d.trace=d),g.enabled===!1&&(g.level="silent");const J=g.level||"info",I=Object.create(d);I.log||(I.log=N),Object.defineProperty(I,"levelVal",{get:W}),Object.defineProperty(I,"level",{get:F,set:M});const C={transmit:o,serialize:P,asObject:g.browser.asObject,levels:V,timestamp:b(g)};I.levels=i.levels,I.level=J,I.setMaxListeners=I.getMaxListeners=I.emit=I.addListener=I.on=I.prependListener=I.once=I.prependOnceListener=I.removeListener=I.removeAllListeners=I.listeners=I.listenerCount=I.eventNames=I.write=I.flush=N,I.serializers=L,I._serialize=P,I._stdErrSerialize=K,I.child=j,o&&(I._logEvent=p());function W(){return this.level==="silent"?1/0:this.levels.values[this.level]}function F(){return this._level}function M(U){if(U!=="silent"&&!this.levels.values[U])throw Error("unknown level "+U);this._level=U,s(C,I,"error","log"),s(C,I,"fatal","error"),s(C,I,"warn","error"),s(C,I,"info","log"),s(C,I,"debug","log"),s(C,I,"trace","log")}function j(U,B){if(!U)throw new Error("missing bindings for child Pino");B=B||{},P&&U.serializers&&(B.serializers=U.serializers);const ee=B.serializers;if(P&&ee){var z=Object.assign({},L,ee),Q=g.browser.serialize===!0?Object.keys(z):P;delete U.serializers,h([U],Q,z,this._stdErrSerialize)}function k(Z){this._childLevel=(Z._childLevel|0)+1,this.error=c(Z,U,"error"),this.fatal=c(Z,U,"fatal"),this.warn=c(Z,U,"warn"),this.info=c(Z,U,"info"),this.debug=c(Z,U,"debug"),this.trace=c(Z,U,"trace"),z&&(this.serializers=z,this._serialize=Q),o&&(this._logEvent=p([].concat(Z._logEvent.bindings,U)))}return k.prototype=this,new k(this)}return I}i.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},i.stdSerializers=r,i.stdTimeFunctions=Object.assign({},{nullTime:G,epochTime:m,unixTime:R,isoTime:w});function s(g,o,d,L){const P=Object.getPrototypeOf(o);o[d]=o.levelVal>o.levels.values[d]?N:P[d]?P[d]:e[d]||e[L]||N,f(g,o,d)}function f(g,o,d){!g.transmit&&o[d]===N||(o[d]=function(L){return function(){const K=g.timestamp(),V=new Array(arguments.length),J=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var I=0;I<V.length;I++)V[I]=arguments[I];if(g.serialize&&!g.asObject&&h(V,this._serialize,this.serializers,this._stdErrSerialize),g.asObject?L.call(J,u(this,d,V,K)):L.apply(J,V),g.transmit){const C=g.transmit.level||o.level,W=i.levels.values[C],F=i.levels.values[d];if(F<W)return;l(this,{ts:K,methodLevel:d,methodValue:F,transmitLevel:C,transmitValue:i.levels.values[g.transmit.level||o.level],send:g.transmit.send,val:o.levelVal},V)}}}(o[d]))}function u(g,o,d,L){g._serialize&&h(d,g._serialize,g.serializers,g._stdErrSerialize);const P=d.slice();let K=P[0];const V={};L&&(V.time=L),V.level=i.levels.values[o];let J=(g._childLevel|0)+1;if(J<1&&(J=1),K!==null&&typeof K=="object"){for(;J--&&typeof P[0]=="object";)Object.assign(V,P.shift());K=P.length?t(P.shift(),P):void 0}else typeof K=="string"&&(K=t(P.shift(),P));return K!==void 0&&(V.msg=K),V}function h(g,o,d,L){for(const P in g)if(L&&g[P]instanceof Error)g[P]=i.stdSerializers.err(g[P]);else if(typeof g[P]=="object"&&!Array.isArray(g[P]))for(const K in g[P])o&&o.indexOf(K)>-1&&K in d&&(g[P][K]=d[K](g[P][K]))}function c(g,o,d){return function(){const L=new Array(1+arguments.length);L[0]=o;for(var P=1;P<L.length;P++)L[P]=arguments[P-1];return g[d].apply(this,L)}}function l(g,o,d){const L=o.send,P=o.ts,K=o.methodLevel,V=o.methodValue,J=o.val,I=g._logEvent.bindings;h(d,g._serialize||Object.keys(g.serializers),g.serializers,g._stdErrSerialize===void 0?!0:g._stdErrSerialize),g._logEvent.ts=P,g._logEvent.messages=d.filter(function(C){return I.indexOf(C)===-1}),g._logEvent.level.label=K,g._logEvent.level.value=V,L(K,g._logEvent,J),g._logEvent=p(I)}function p(g){return{ts:0,messages:[],bindings:g||[],level:{label:"",value:0}}}function _(g){const o={type:g.constructor.name,msg:g.message,stack:g.stack};for(const d in g)o[d]===void 0&&(o[d]=g[d]);return o}function b(g){return typeof g.timestamp=="function"?g.timestamp:g.timestamp===!1?G:m}function O(){return{}}function A(g){return g}function N(){}function G(){return!1}function m(){return Date.now()}function R(){return Math.round(Date.now()/1e3)}function w(){return new Date(Date.now()).toISOString()}function E(){function g(o){return typeof o<"u"&&o}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return g(self)||g(window)||g(this)||{}}}return On}var jt={},Xi;function Ji(){return Xi||(Xi=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.PINO_CUSTOM_CONTEXT_KEY=jt.PINO_LOGGER_DEFAULTS=void 0,jt.PINO_LOGGER_DEFAULTS={level:"info"},jt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),jt}var tt={},Qi;function Bu(){if(Qi)return tt;Qi=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.generateChildLogger=tt.formatChildLoggerContext=tt.getLoggerContext=tt.setBrowserLoggerContext=tt.getBrowserLoggerContext=tt.getDefaultLoggerOptions=void 0;const t=Ji();function e(u){return Object.assign(Object.assign({},u),{level:u?.level||t.PINO_LOGGER_DEFAULTS.level})}tt.getDefaultLoggerOptions=e;function r(u,h=t.PINO_CUSTOM_CONTEXT_KEY){return u[h]||""}tt.getBrowserLoggerContext=r;function n(u,h,c=t.PINO_CUSTOM_CONTEXT_KEY){return u[c]=h,u}tt.setBrowserLoggerContext=n;function i(u,h=t.PINO_CUSTOM_CONTEXT_KEY){let c="";return typeof u.bindings>"u"?c=r(u,h):c=u.bindings().context||"",c}tt.getLoggerContext=i;function s(u,h,c=t.PINO_CUSTOM_CONTEXT_KEY){const l=i(u,c);return l.trim()?`${l}/${h}`:h}tt.formatChildLoggerContext=s;function f(u,h,c=t.PINO_CUSTOM_CONTEXT_KEY){const l=s(u,h,c),p=u.child({context:l});return n(p,l,c)}return tt.generateChildLogger=f,tt}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=$u,r=e.__importDefault(Fu());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Ji(),t),e.__exportStar(Bu(),t)})(Se);class zu extends Mt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Ku extends Mt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Hu{constructor(e,r){this.logger=e,this.core=r}}class Gu extends Mt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Vu extends Mt{constructor(e){super()}}class Wu{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class Yu extends Mt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class qu extends Mt{constructor(e,r){super(),this.core=e,this.logger=r}}class ku{constructor(e,r){this.projectId=e,this.logger=r}}var In={},qt={},Pr={},Lr={};Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.BrowserRandomSource=void 0;const Zi=65536;class Xu{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=Zi)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Zi)));return r}}Lr.BrowserRandomSource=Xu;function Ju(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Nr={},ct={};Object.defineProperty(ct,"__esModule",{value:!0});function Qu(t){for(var e=0;e<t.length;e++)t[e]=0;return t}ct.wipe=Qu;var Zu={},ef=Object.freeze({__proto__:null,default:Zu}),tf=Gt(ef);Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.NodeRandomSource=void 0;const rf=ct;class nf{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Ju<"u"){const e=tf;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,rf.wipe)(r),n}}Nr.NodeRandomSource=nf,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.SystemRandomSource=void 0;const sf=Lr,of=Nr;class af{constructor(){if(this.isAvailable=!1,this.name="",this._source=new sf.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new of.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Pr.SystemRandomSource=af;var re={},es={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(u,h){var c=u>>>16&65535,l=u&65535,p=h>>>16&65535,_=h&65535;return l*_+(c*_+l*p<<16>>>0)|0}t.mul=Math.imul||e;function r(u,h){return u+h|0}t.add=r;function n(u,h){return u-h|0}t.sub=n;function i(u,h){return u<<h|u>>>32-h}t.rotl=i;function s(u,h){return u<<32-h|u>>>h}t.rotr=s;function f(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}t.isInteger=Number.isInteger||f,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(u){return t.isInteger(u)&&u>=-t.MAX_SAFE_INTEGER&&u<=t.MAX_SAFE_INTEGER}})(es),Object.defineProperty(re,"__esModule",{value:!0});var ts=es;function cf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}re.readInt16BE=cf;function uf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}re.readUint16BE=uf;function ff(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}re.readInt16LE=ff;function hf(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}re.readUint16LE=hf;function rs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}re.writeUint16BE=rs,re.writeInt16BE=rs;function ns(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}re.writeUint16LE=ns,re.writeInt16LE=ns;function Tn(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}re.readInt32BE=Tn;function xn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}re.readUint32BE=xn;function Rn(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}re.readInt32LE=Rn;function Cn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}re.readUint32LE=Cn;function Ur(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}re.writeUint32BE=Ur,re.writeInt32BE=Ur;function Mr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}re.writeUint32LE=Mr,re.writeInt32LE=Mr;function lf(t,e){e===void 0&&(e=0);var r=Tn(t,e),n=Tn(t,e+4);return r*4294967296+n-(n>>31)*4294967296}re.readInt64BE=lf;function df(t,e){e===void 0&&(e=0);var r=xn(t,e),n=xn(t,e+4);return r*4294967296+n}re.readUint64BE=df;function gf(t,e){e===void 0&&(e=0);var r=Rn(t,e),n=Rn(t,e+4);return n*4294967296+r-(r>>31)*4294967296}re.readInt64LE=gf;function yf(t,e){e===void 0&&(e=0);var r=Cn(t,e),n=Cn(t,e+4);return n*4294967296+r}re.readUint64LE=yf;function is(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ur(t/4294967296>>>0,e,r),Ur(t>>>0,e,r+4),e}re.writeUint64BE=is,re.writeInt64BE=is;function ss(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Mr(t>>>0,e,r),Mr(t/4294967296>>>0,e,r+4),e}re.writeUint64LE=ss,re.writeInt64LE=ss;function _f(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}re.readUintBE=_f;function pf(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}re.readUintLE=pf;function bf(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ts.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}re.writeUintBE=bf;function vf(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ts.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}re.writeUintLE=vf;function wf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}re.readFloat32BE=wf;function Ef(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}re.readFloat32LE=Ef;function mf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}re.readFloat64BE=mf;function Df(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}re.readFloat64LE=Df;function Sf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}re.writeFloat32BE=Sf;function Of(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}re.writeFloat32LE=Of;function If(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}re.writeFloat64BE=If;function Tf(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}re.writeFloat64LE=Tf,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Pr,r=re,n=ct;t.defaultRandomSource=new e.SystemRandomSource;function i(c,l=t.defaultRandomSource){return l.randomBytes(c)}t.randomBytes=i;function s(c=t.defaultRandomSource){const l=i(4,c),p=(0,r.readUint32LE)(l);return(0,n.wipe)(l),p}t.randomUint32=s;const f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(c,l=f,p=t.defaultRandomSource){if(l.length<2)throw new Error("randomString charset is too short");if(l.length>256)throw new Error("randomString charset is too long");let _="";const b=l.length,O=256-256%b;for(;c>0;){const A=i(Math.ceil(c*256/O),p);for(let N=0;N<A.length&&c>0;N++){const G=A[N];G<O&&(_+=l.charAt(G%b),c--)}(0,n.wipe)(A)}return _}t.randomString=u;function h(c,l=f,p=t.defaultRandomSource){const _=Math.ceil(c/(Math.log(l.length)/Math.LN2));return u(_,l,p)}t.randomStringForEntropy=h}(qt);var os={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=ct;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(h,c){if(c===void 0&&(c=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=c,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&c>0;)this._buffer[this._bufferLength++]=h[l++],c--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(c>=this.blockSize&&(l=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,l,c),c%=this.blockSize);c>0;)this._buffer[this._bufferLength++]=h[l++],c--;return this},u.prototype.finish=function(h){if(!this._finished){var c=this._bytesHashed,l=this._bufferLength,p=c/536870912|0,_=c<<3,b=c%128<112?128:256;this._buffer[l]=128;for(var O=l+1;O<b-8;O++)this._buffer[O]=0;e.writeUint32BE(p,this._buffer,b-8),e.writeUint32BE(_,this._buffer,b-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,b),this._finished=!0}for(var O=0;O<this.digestLength/8;O++)e.writeUint32BE(this._stateHi[O],h,O*8),e.writeUint32BE(this._stateLo[O],h,O*8+4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(u,h,c,l,p,_,b){for(var O=c[0],A=c[1],N=c[2],G=c[3],m=c[4],R=c[5],w=c[6],E=c[7],g=l[0],o=l[1],d=l[2],L=l[3],P=l[4],K=l[5],V=l[6],J=l[7],I,C,W,F,M,j,U,B;b>=128;){for(var ee=0;ee<16;ee++){var z=8*ee+_;u[ee]=e.readUint32BE(p,z),h[ee]=e.readUint32BE(p,z+4)}for(var ee=0;ee<80;ee++){var Q=O,k=A,Z=N,x=G,T=m,D=R,a=w,v=E,H=g,Y=o,he=d,pe=L,de=P,we=K,Ue=V,Ae=J;if(I=E,C=J,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=(m>>>14|P<<32-14)^(m>>>18|P<<32-18)^(P>>>41-32|m<<32-(41-32)),C=(P>>>14|m<<32-14)^(P>>>18|m<<32-18)^(m>>>41-32|P<<32-(41-32)),M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,I=m&R^~m&w,C=P&K^~P&V,M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,I=i[ee*2],C=i[ee*2+1],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,I=u[ee%16],C=h[ee%16],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,W=U&65535|B<<16,F=M&65535|j<<16,I=W,C=F,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=(O>>>28|g<<32-28)^(g>>>34-32|O<<32-(34-32))^(g>>>39-32|O<<32-(39-32)),C=(g>>>28|O<<32-28)^(O>>>34-32|g<<32-(34-32))^(O>>>39-32|g<<32-(39-32)),M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,I=O&A^O&N^A&N,C=g&o^g&d^o&d,M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,v=U&65535|B<<16,Ae=M&65535|j<<16,I=x,C=pe,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=W,C=F,M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,x=U&65535|B<<16,pe=M&65535|j<<16,A=Q,N=k,G=Z,m=x,R=T,w=D,E=a,O=v,o=H,d=Y,L=he,P=pe,K=de,V=we,J=Ue,g=Ae,ee%16===15)for(var z=0;z<16;z++)I=u[z],C=h[z],M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=u[(z+9)%16],C=h[(z+9)%16],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,W=u[(z+1)%16],F=h[(z+1)%16],I=(W>>>1|F<<32-1)^(W>>>8|F<<32-8)^W>>>7,C=(F>>>1|W<<32-1)^(F>>>8|W<<32-8)^(F>>>7|W<<32-7),M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,W=u[(z+14)%16],F=h[(z+14)%16],I=(W>>>19|F<<32-19)^(F>>>61-32|W<<32-(61-32))^W>>>6,C=(F>>>19|W<<32-19)^(W>>>61-32|F<<32-(61-32))^(F>>>6|W<<32-6),M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,u[z]=U&65535|B<<16,h[z]=M&65535|j<<16}I=O,C=g,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=c[0],C=l[0],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,c[0]=O=U&65535|B<<16,l[0]=g=M&65535|j<<16,I=A,C=o,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=c[1],C=l[1],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,c[1]=A=U&65535|B<<16,l[1]=o=M&65535|j<<16,I=N,C=d,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=c[2],C=l[2],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,c[2]=N=U&65535|B<<16,l[2]=d=M&65535|j<<16,I=G,C=L,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=c[3],C=l[3],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,c[3]=G=U&65535|B<<16,l[3]=L=M&65535|j<<16,I=m,C=P,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=c[4],C=l[4],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,c[4]=m=U&65535|B<<16,l[4]=P=M&65535|j<<16,I=R,C=K,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=c[5],C=l[5],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,c[5]=R=U&65535|B<<16,l[5]=K=M&65535|j<<16,I=w,C=V,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=c[6],C=l[6],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,c[6]=w=U&65535|B<<16,l[6]=V=M&65535|j<<16,I=E,C=J,M=C&65535,j=C>>>16,U=I&65535,B=I>>>16,I=c[7],C=l[7],M+=C&65535,j+=C>>>16,U+=I&65535,B+=I>>>16,j+=M>>>16,U+=j>>>16,B+=U>>>16,c[7]=E=U&65535|B<<16,l[7]=J=M&65535|j<<16,_+=128,b-=128}return _}function f(u){var h=new n;h.update(u);var c=h.digest();return h.clean(),c}t.hash=f})(os),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=qt,r=os,n=ct;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(x){const T=new Float64Array(16);if(x)for(let D=0;D<x.length;D++)T[D]=x[D];return T}const s=new Uint8Array(32);s[0]=9;const f=i(),u=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),p=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(x,T){for(let D=0;D<16;D++)x[D]=T[D]|0}function O(x){let T=1;for(let D=0;D<16;D++){let a=x[D]+T+65535;T=Math.floor(a/65536),x[D]=a-T*65536}x[0]+=T-1+37*(T-1)}function A(x,T,D){const a=~(D-1);for(let v=0;v<16;v++){const H=a&(x[v]^T[v]);x[v]^=H,T[v]^=H}}function N(x,T){const D=i(),a=i();for(let v=0;v<16;v++)a[v]=T[v];O(a),O(a),O(a);for(let v=0;v<2;v++){D[0]=a[0]-65517;for(let Y=1;Y<15;Y++)D[Y]=a[Y]-65535-(D[Y-1]>>16&1),D[Y-1]&=65535;D[15]=a[15]-32767-(D[14]>>16&1);const H=D[15]>>16&1;D[14]&=65535,A(a,D,1-H)}for(let v=0;v<16;v++)x[2*v]=a[v]&255,x[2*v+1]=a[v]>>8}function G(x,T){let D=0;for(let a=0;a<32;a++)D|=x[a]^T[a];return(1&D-1>>>8)-1}function m(x,T){const D=new Uint8Array(32),a=new Uint8Array(32);return N(D,x),N(a,T),G(D,a)}function R(x){const T=new Uint8Array(32);return N(T,x),T[0]&1}function w(x,T){for(let D=0;D<16;D++)x[D]=T[2*D]+(T[2*D+1]<<8);x[15]&=32767}function E(x,T,D){for(let a=0;a<16;a++)x[a]=T[a]+D[a]}function g(x,T,D){for(let a=0;a<16;a++)x[a]=T[a]-D[a]}function o(x,T,D){let a,v,H=0,Y=0,he=0,pe=0,de=0,we=0,Ue=0,Ae=0,_e=0,ge=0,le=0,ue=0,ae=0,oe=0,se=0,te=0,fe=0,ye=0,ne=0,be=0,ve=0,me=0,De=0,Ee=0,bt=0,mt=0,Rt=0,ut=0,Bt=0,wr=0,Qr=0,Me=D[0],Pe=D[1],$e=D[2],je=D[3],Fe=D[4],Le=D[5],He=D[6],Ge=D[7],Ve=D[8],We=D[9],Ye=D[10],ze=D[11],Be=D[12],Re=D[13],qe=D[14],ke=D[15];a=T[0],H+=a*Me,Y+=a*Pe,he+=a*$e,pe+=a*je,de+=a*Fe,we+=a*Le,Ue+=a*He,Ae+=a*Ge,_e+=a*Ve,ge+=a*We,le+=a*Ye,ue+=a*ze,ae+=a*Be,oe+=a*Re,se+=a*qe,te+=a*ke,a=T[1],Y+=a*Me,he+=a*Pe,pe+=a*$e,de+=a*je,we+=a*Fe,Ue+=a*Le,Ae+=a*He,_e+=a*Ge,ge+=a*Ve,le+=a*We,ue+=a*Ye,ae+=a*ze,oe+=a*Be,se+=a*Re,te+=a*qe,fe+=a*ke,a=T[2],he+=a*Me,pe+=a*Pe,de+=a*$e,we+=a*je,Ue+=a*Fe,Ae+=a*Le,_e+=a*He,ge+=a*Ge,le+=a*Ve,ue+=a*We,ae+=a*Ye,oe+=a*ze,se+=a*Be,te+=a*Re,fe+=a*qe,ye+=a*ke,a=T[3],pe+=a*Me,de+=a*Pe,we+=a*$e,Ue+=a*je,Ae+=a*Fe,_e+=a*Le,ge+=a*He,le+=a*Ge,ue+=a*Ve,ae+=a*We,oe+=a*Ye,se+=a*ze,te+=a*Be,fe+=a*Re,ye+=a*qe,ne+=a*ke,a=T[4],de+=a*Me,we+=a*Pe,Ue+=a*$e,Ae+=a*je,_e+=a*Fe,ge+=a*Le,le+=a*He,ue+=a*Ge,ae+=a*Ve,oe+=a*We,se+=a*Ye,te+=a*ze,fe+=a*Be,ye+=a*Re,ne+=a*qe,be+=a*ke,a=T[5],we+=a*Me,Ue+=a*Pe,Ae+=a*$e,_e+=a*je,ge+=a*Fe,le+=a*Le,ue+=a*He,ae+=a*Ge,oe+=a*Ve,se+=a*We,te+=a*Ye,fe+=a*ze,ye+=a*Be,ne+=a*Re,be+=a*qe,ve+=a*ke,a=T[6],Ue+=a*Me,Ae+=a*Pe,_e+=a*$e,ge+=a*je,le+=a*Fe,ue+=a*Le,ae+=a*He,oe+=a*Ge,se+=a*Ve,te+=a*We,fe+=a*Ye,ye+=a*ze,ne+=a*Be,be+=a*Re,ve+=a*qe,me+=a*ke,a=T[7],Ae+=a*Me,_e+=a*Pe,ge+=a*$e,le+=a*je,ue+=a*Fe,ae+=a*Le,oe+=a*He,se+=a*Ge,te+=a*Ve,fe+=a*We,ye+=a*Ye,ne+=a*ze,be+=a*Be,ve+=a*Re,me+=a*qe,De+=a*ke,a=T[8],_e+=a*Me,ge+=a*Pe,le+=a*$e,ue+=a*je,ae+=a*Fe,oe+=a*Le,se+=a*He,te+=a*Ge,fe+=a*Ve,ye+=a*We,ne+=a*Ye,be+=a*ze,ve+=a*Be,me+=a*Re,De+=a*qe,Ee+=a*ke,a=T[9],ge+=a*Me,le+=a*Pe,ue+=a*$e,ae+=a*je,oe+=a*Fe,se+=a*Le,te+=a*He,fe+=a*Ge,ye+=a*Ve,ne+=a*We,be+=a*Ye,ve+=a*ze,me+=a*Be,De+=a*Re,Ee+=a*qe,bt+=a*ke,a=T[10],le+=a*Me,ue+=a*Pe,ae+=a*$e,oe+=a*je,se+=a*Fe,te+=a*Le,fe+=a*He,ye+=a*Ge,ne+=a*Ve,be+=a*We,ve+=a*Ye,me+=a*ze,De+=a*Be,Ee+=a*Re,bt+=a*qe,mt+=a*ke,a=T[11],ue+=a*Me,ae+=a*Pe,oe+=a*$e,se+=a*je,te+=a*Fe,fe+=a*Le,ye+=a*He,ne+=a*Ge,be+=a*Ve,ve+=a*We,me+=a*Ye,De+=a*ze,Ee+=a*Be,bt+=a*Re,mt+=a*qe,Rt+=a*ke,a=T[12],ae+=a*Me,oe+=a*Pe,se+=a*$e,te+=a*je,fe+=a*Fe,ye+=a*Le,ne+=a*He,be+=a*Ge,ve+=a*Ve,me+=a*We,De+=a*Ye,Ee+=a*ze,bt+=a*Be,mt+=a*Re,Rt+=a*qe,ut+=a*ke,a=T[13],oe+=a*Me,se+=a*Pe,te+=a*$e,fe+=a*je,ye+=a*Fe,ne+=a*Le,be+=a*He,ve+=a*Ge,me+=a*Ve,De+=a*We,Ee+=a*Ye,bt+=a*ze,mt+=a*Be,Rt+=a*Re,ut+=a*qe,Bt+=a*ke,a=T[14],se+=a*Me,te+=a*Pe,fe+=a*$e,ye+=a*je,ne+=a*Fe,be+=a*Le,ve+=a*He,me+=a*Ge,De+=a*Ve,Ee+=a*We,bt+=a*Ye,mt+=a*ze,Rt+=a*Be,ut+=a*Re,Bt+=a*qe,wr+=a*ke,a=T[15],te+=a*Me,fe+=a*Pe,ye+=a*$e,ne+=a*je,be+=a*Fe,ve+=a*Le,me+=a*He,De+=a*Ge,Ee+=a*Ve,bt+=a*We,mt+=a*Ye,Rt+=a*ze,ut+=a*Be,Bt+=a*Re,wr+=a*qe,Qr+=a*ke,H+=38*fe,Y+=38*ye,he+=38*ne,pe+=38*be,de+=38*ve,we+=38*me,Ue+=38*De,Ae+=38*Ee,_e+=38*bt,ge+=38*mt,le+=38*Rt,ue+=38*ut,ae+=38*Bt,oe+=38*wr,se+=38*Qr,v=1,a=H+v+65535,v=Math.floor(a/65536),H=a-v*65536,a=Y+v+65535,v=Math.floor(a/65536),Y=a-v*65536,a=he+v+65535,v=Math.floor(a/65536),he=a-v*65536,a=pe+v+65535,v=Math.floor(a/65536),pe=a-v*65536,a=de+v+65535,v=Math.floor(a/65536),de=a-v*65536,a=we+v+65535,v=Math.floor(a/65536),we=a-v*65536,a=Ue+v+65535,v=Math.floor(a/65536),Ue=a-v*65536,a=Ae+v+65535,v=Math.floor(a/65536),Ae=a-v*65536,a=_e+v+65535,v=Math.floor(a/65536),_e=a-v*65536,a=ge+v+65535,v=Math.floor(a/65536),ge=a-v*65536,a=le+v+65535,v=Math.floor(a/65536),le=a-v*65536,a=ue+v+65535,v=Math.floor(a/65536),ue=a-v*65536,a=ae+v+65535,v=Math.floor(a/65536),ae=a-v*65536,a=oe+v+65535,v=Math.floor(a/65536),oe=a-v*65536,a=se+v+65535,v=Math.floor(a/65536),se=a-v*65536,a=te+v+65535,v=Math.floor(a/65536),te=a-v*65536,H+=v-1+37*(v-1),v=1,a=H+v+65535,v=Math.floor(a/65536),H=a-v*65536,a=Y+v+65535,v=Math.floor(a/65536),Y=a-v*65536,a=he+v+65535,v=Math.floor(a/65536),he=a-v*65536,a=pe+v+65535,v=Math.floor(a/65536),pe=a-v*65536,a=de+v+65535,v=Math.floor(a/65536),de=a-v*65536,a=we+v+65535,v=Math.floor(a/65536),we=a-v*65536,a=Ue+v+65535,v=Math.floor(a/65536),Ue=a-v*65536,a=Ae+v+65535,v=Math.floor(a/65536),Ae=a-v*65536,a=_e+v+65535,v=Math.floor(a/65536),_e=a-v*65536,a=ge+v+65535,v=Math.floor(a/65536),ge=a-v*65536,a=le+v+65535,v=Math.floor(a/65536),le=a-v*65536,a=ue+v+65535,v=Math.floor(a/65536),ue=a-v*65536,a=ae+v+65535,v=Math.floor(a/65536),ae=a-v*65536,a=oe+v+65535,v=Math.floor(a/65536),oe=a-v*65536,a=se+v+65535,v=Math.floor(a/65536),se=a-v*65536,a=te+v+65535,v=Math.floor(a/65536),te=a-v*65536,H+=v-1+37*(v-1),x[0]=H,x[1]=Y,x[2]=he,x[3]=pe,x[4]=de,x[5]=we,x[6]=Ue,x[7]=Ae,x[8]=_e,x[9]=ge,x[10]=le,x[11]=ue,x[12]=ae,x[13]=oe,x[14]=se,x[15]=te}function d(x,T){o(x,T,T)}function L(x,T){const D=i();let a;for(a=0;a<16;a++)D[a]=T[a];for(a=253;a>=0;a--)d(D,D),a!==2&&a!==4&&o(D,D,T);for(a=0;a<16;a++)x[a]=D[a]}function P(x,T){const D=i();let a;for(a=0;a<16;a++)D[a]=T[a];for(a=250;a>=0;a--)d(D,D),a!==1&&o(D,D,T);for(a=0;a<16;a++)x[a]=D[a]}function K(x,T){const D=i(),a=i(),v=i(),H=i(),Y=i(),he=i(),pe=i(),de=i(),we=i();g(D,x[1],x[0]),g(we,T[1],T[0]),o(D,D,we),E(a,x[0],x[1]),E(we,T[0],T[1]),o(a,a,we),o(v,x[3],T[3]),o(v,v,c),o(H,x[2],T[2]),E(H,H,H),g(Y,a,D),g(he,H,v),E(pe,H,v),E(de,a,D),o(x[0],Y,he),o(x[1],de,pe),o(x[2],pe,he),o(x[3],Y,de)}function V(x,T,D){for(let a=0;a<4;a++)A(x[a],T[a],D)}function J(x,T){const D=i(),a=i(),v=i();L(v,T[2]),o(D,T[0],v),o(a,T[1],v),N(x,a),x[31]^=R(D)<<7}function I(x,T,D){b(x[0],f),b(x[1],u),b(x[2],u),b(x[3],f);for(let a=255;a>=0;--a){const v=D[a/8|0]>>(a&7)&1;V(x,T,v),K(T,x),K(x,x),V(x,T,v)}}function C(x,T){const D=[i(),i(),i(),i()];b(D[0],l),b(D[1],p),b(D[2],u),o(D[3],l,p),I(x,D,T)}function W(x){if(x.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const T=(0,r.hash)(x);T[0]&=248,T[31]&=127,T[31]|=64;const D=new Uint8Array(32),a=[i(),i(),i(),i()];C(a,T),J(D,a);const v=new Uint8Array(64);return v.set(x),v.set(D,32),{publicKey:D,secretKey:v}}t.generateKeyPairFromSeed=W;function F(x){const T=(0,e.randomBytes)(32,x),D=W(T);return(0,n.wipe)(T),D}t.generateKeyPair=F;function M(x){if(x.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(x.subarray(32))}t.extractPublicKeyFromSecretKey=M;const j=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function U(x,T){let D,a,v,H;for(a=63;a>=32;--a){for(D=0,v=a-32,H=a-12;v<H;++v)T[v]+=D-16*T[a]*j[v-(a-32)],D=Math.floor((T[v]+128)/256),T[v]-=D*256;T[v]+=D,T[a]=0}for(D=0,v=0;v<32;v++)T[v]+=D-(T[31]>>4)*j[v],D=T[v]>>8,T[v]&=255;for(v=0;v<32;v++)T[v]-=D*j[v];for(a=0;a<32;a++)T[a+1]+=T[a]>>8,x[a]=T[a]&255}function B(x){const T=new Float64Array(64);for(let D=0;D<64;D++)T[D]=x[D];for(let D=0;D<64;D++)x[D]=0;U(x,T)}function ee(x,T){const D=new Float64Array(64),a=[i(),i(),i(),i()],v=(0,r.hash)(x.subarray(0,32));v[0]&=248,v[31]&=127,v[31]|=64;const H=new Uint8Array(64);H.set(v.subarray(32),32);const Y=new r.SHA512;Y.update(H.subarray(32)),Y.update(T);const he=Y.digest();Y.clean(),B(he),C(a,he),J(H,a),Y.reset(),Y.update(H.subarray(0,32)),Y.update(x.subarray(32)),Y.update(T);const pe=Y.digest();B(pe);for(let de=0;de<32;de++)D[de]=he[de];for(let de=0;de<32;de++)for(let we=0;we<32;we++)D[de+we]+=pe[de]*v[we];return U(H.subarray(32),D),H}t.sign=ee;function z(x,T){const D=i(),a=i(),v=i(),H=i(),Y=i(),he=i(),pe=i();return b(x[2],u),w(x[1],T),d(v,x[1]),o(H,v,h),g(v,v,x[2]),E(H,x[2],H),d(Y,H),d(he,Y),o(pe,he,Y),o(D,pe,v),o(D,D,H),P(D,D),o(D,D,v),o(D,D,H),o(D,D,H),o(x[0],D,H),d(a,x[0]),o(a,a,H),m(a,v)&&o(x[0],x[0],_),d(a,x[0]),o(a,a,H),m(a,v)?-1:(R(x[0])===T[31]>>7&&g(x[0],f,x[0]),o(x[3],x[0],x[1]),0)}function Q(x,T,D){const a=new Uint8Array(32),v=[i(),i(),i(),i()],H=[i(),i(),i(),i()];if(D.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(z(H,x))return!1;const Y=new r.SHA512;Y.update(D.subarray(0,32)),Y.update(x),Y.update(T);const he=Y.digest();return B(he),I(v,H,he),C(H,D.subarray(32)),K(v,H),J(a,v),!G(D,a)}t.verify=Q;function k(x){let T=[i(),i(),i(),i()];if(z(T,x))throw new Error("Ed25519: invalid public key");let D=i(),a=i(),v=T[1];E(D,u,v),g(a,u,v),L(a,a),o(D,D,a);let H=new Uint8Array(32);return N(H,D),H}t.convertPublicKeyToX25519=k;function Z(x){const T=(0,r.hash)(x.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const D=new Uint8Array(T.subarray(0,32));return(0,n.wipe)(T),D}t.convertSecretKeyToX25519=Z}(In);const xf="EdDSA",Rf="JWT",as=".",cs="base64url",Cf="utf8",Af="utf8",Pf=":",Lf="did",Nf="key",us="base58btc",Uf="z",Mf="K36",$f=32;function An(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function fs(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?An(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Pn(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=fs(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return An(r)}function jf(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),f=s.charCodeAt(0);if(r[f]!==255)throw new TypeError(s+" is ambiguous");r[f]=i}var u=t.length,h=t.charAt(0),c=Math.log(u)/Math.log(256),l=Math.log(256)/Math.log(u);function p(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var A=0,N=0,G=0,m=O.length;G!==m&&O[G]===0;)G++,A++;for(var R=(m-G)*l+1>>>0,w=new Uint8Array(R);G!==m;){for(var E=O[G],g=0,o=R-1;(E!==0||g<N)&&o!==-1;o--,g++)E+=256*w[o]>>>0,w[o]=E%u>>>0,E=E/u>>>0;if(E!==0)throw new Error("Non-zero carry");N=g,G++}for(var d=R-N;d!==R&&w[d]===0;)d++;for(var L=h.repeat(A);d<R;++d)L+=t.charAt(w[d]);return L}function _(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var A=0;if(O[A]!==" "){for(var N=0,G=0;O[A]===h;)N++,A++;for(var m=(O.length-A)*c+1>>>0,R=new Uint8Array(m);O[A];){var w=r[O.charCodeAt(A)];if(w===255)return;for(var E=0,g=m-1;(w!==0||E<G)&&g!==-1;g--,E++)w+=u*R[g]>>>0,R[g]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");G=E,A++}if(O[A]!==" "){for(var o=m-G;o!==m&&R[o]===0;)o++;for(var d=new Uint8Array(N+(m-o)),L=N;o!==m;)d[L++]=R[o++];return d}}}function b(O){var A=_(O);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:p,decodeUnsafe:_,decode:b}}var Ff=jf,Bf=Ff;const hs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},zf=t=>new TextEncoder().encode(t),Kf=t=>new TextDecoder().decode(t);class Hf{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Gf{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ls(this,e)}}class Vf{constructor(e){this.decoders=e}or(e){return ls(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ls=(t,e)=>new Vf({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Wf{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Hf(e,r,n),this.decoder=new Gf(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const $r=({name:t,prefix:e,encode:r,decode:n})=>new Wf(t,e,r,n),fr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Bf(r,e);return $r({prefix:t,name:e,encode:n,decode:s=>hs(i(s))})},Yf=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const f=new Uint8Array(s*r/8|0);let u=0,h=0,c=0;for(let l=0;l<s;++l){const p=i[t[l]];if(p===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|p,u+=r,u>=8&&(u-=8,f[c++]=255&h>>u)}if(u>=r||255&h<<8-u)throw new SyntaxError("Unexpected end of data");return f},qf=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",f=0,u=0;for(let h=0;h<t.length;++h)for(u=u<<8|t[h],f+=8;f>r;)f-=r,s+=e[i&u>>f];if(f&&(s+=e[i&u<<r-f]),n)for(;s.length*r&7;)s+="=";return s},Je=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>$r({prefix:e,name:t,encode(i){return qf(i,n,r)},decode(i){return Yf(i,n,r,t)}}),kf=$r({prefix:"\0",name:"identity",encode:t=>Kf(t),decode:t=>zf(t)});var Xf=Object.freeze({__proto__:null,identity:kf});const Jf=Je({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Qf=Object.freeze({__proto__:null,base2:Jf});const Zf=Je({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var eh=Object.freeze({__proto__:null,base8:Zf});const th=fr({prefix:"9",name:"base10",alphabet:"0123456789"});var rh=Object.freeze({__proto__:null,base10:th});const nh=Je({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ih=Je({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var sh=Object.freeze({__proto__:null,base16:nh,base16upper:ih});const oh=Je({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ah=Je({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ch=Je({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),uh=Je({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fh=Je({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hh=Je({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),lh=Je({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),dh=Je({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gh=Je({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var yh=Object.freeze({__proto__:null,base32:oh,base32upper:ah,base32pad:ch,base32padupper:uh,base32hex:fh,base32hexupper:hh,base32hexpad:lh,base32hexpadupper:dh,base32z:gh});const _h=fr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ph=fr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var bh=Object.freeze({__proto__:null,base36:_h,base36upper:ph});const vh=fr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),wh=fr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Eh=Object.freeze({__proto__:null,base58btc:vh,base58flickr:wh});const mh=Je({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Dh=Je({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Sh=Je({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Oh=Je({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ih=Object.freeze({__proto__:null,base64:mh,base64pad:Dh,base64url:Sh,base64urlpad:Oh});const ds=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Th=ds.reduce((t,e,r)=>(t[r]=e,t),[]),xh=ds.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Rh(t){return t.reduce((e,r)=>(e+=Th[r],e),"")}function Ch(t){const e=[];for(const r of t){const n=xh[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const Ah=$r({prefix:"\u{1F680}",name:"base256emoji",encode:Rh,decode:Ch});var Ph=Object.freeze({__proto__:null,base256emoji:Ah}),Lh=ys,gs=128,Nh=127,Uh=~Nh,Mh=Math.pow(2,31);function ys(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Mh;)e[r++]=t&255|gs,t/=128;for(;t&Uh;)e[r++]=t&255|gs,t>>>=7;return e[r]=t|0,ys.bytes=r-n+1,e}var $h=Ln,jh=128,_s=127;function Ln(t,n){var r=0,n=n||0,i=0,s=n,f,u=t.length;do{if(s>=u)throw Ln.bytes=0,new RangeError("Could not decode varint");f=t[s++],r+=i<28?(f&_s)<<i:(f&_s)*Math.pow(2,i),i+=7}while(f>=jh);return Ln.bytes=s-n,r}var Fh=Math.pow(2,7),Bh=Math.pow(2,14),zh=Math.pow(2,21),Kh=Math.pow(2,28),Hh=Math.pow(2,35),Gh=Math.pow(2,42),Vh=Math.pow(2,49),Wh=Math.pow(2,56),Yh=Math.pow(2,63),qh=function(t){return t<Fh?1:t<Bh?2:t<zh?3:t<Kh?4:t<Hh?5:t<Gh?6:t<Vh?7:t<Wh?8:t<Yh?9:10},kh={encode:Lh,decode:$h,encodingLength:qh},ps=kh;const bs=(t,e,r=0)=>(ps.encode(t,e,r),e),vs=t=>ps.encodingLength(t),Nn=(t,e)=>{const r=e.byteLength,n=vs(t),i=n+vs(r),s=new Uint8Array(i+r);return bs(t,s,0),bs(r,s,n),s.set(e,i),new Xh(t,r,e,s)};class Xh{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const ws=({name:t,code:e,encode:r})=>new Jh(t,e,r);class Jh{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Nn(this.code,r):r.then(n=>Nn(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Es=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Qh=ws({name:"sha2-256",code:18,encode:Es("SHA-256")}),Zh=ws({name:"sha2-512",code:19,encode:Es("SHA-512")});var el=Object.freeze({__proto__:null,sha256:Qh,sha512:Zh});const ms=0,tl="identity",Ds=hs;var rl=Object.freeze({__proto__:null,identity:{code:ms,name:tl,encode:Ds,digest:t=>Nn(ms,Ds(t))}});new TextEncoder,new TextDecoder;const Ss={...Xf,...Qf,...eh,...rh,...sh,...yh,...bh,...Eh,...Ih,...Ph};({...el,...rl});function Os(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Is=Os("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Un=Os("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=fs(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ts={utf8:Is,"utf-8":Is,hex:Ss.base16,latin1:Un,ascii:Un,binary:Un,...Ss};function rt(t,e="utf8"){const r=Ts[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function nt(t,e="utf8"){const r=Ts[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?An(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function jr(t){return rt(nt(rr(t),Cf),cs)}function xs(t){const e=nt(Mf,us),r=Uf+rt(Pn([e,t]),us);return[Lf,Nf,r].join(Pf)}function nl(t){return rt(t,cs)}function il(t){return nt([jr(t.header),jr(t.payload)].join(as),Af)}function sl(t){return[jr(t.header),jr(t.payload),nl(t.signature)].join(as)}function Rs(t=qt.randomBytes($f)){return In.generateKeyPairFromSeed(t)}async function ol(t,e,r,n,i=ce.fromMiliseconds(Date.now())){const s={alg:xf,typ:Rf},f=xs(n.publicKey),u=i+r,h={iss:f,sub:t,aud:e,iat:i,exp:u},c=il({header:s,payload:h}),l=In.sign(n.secretKey,c);return sl({header:s,payload:h,signature:l})}var Mn={},Fr={};Object.defineProperty(Fr,"__esModule",{value:!0});var Ze=re,$n=ct,al=20;function cl(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,f=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],c=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],p=r[19]<<24|r[18]<<16|r[17]<<8|r[16],_=r[23]<<24|r[22]<<16|r[21]<<8|r[20],b=r[27]<<24|r[26]<<16|r[25]<<8|r[24],O=r[31]<<24|r[30]<<16|r[29]<<8|r[28],A=e[3]<<24|e[2]<<16|e[1]<<8|e[0],N=e[7]<<24|e[6]<<16|e[5]<<8|e[4],G=e[11]<<24|e[10]<<16|e[9]<<8|e[8],m=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=n,w=i,E=s,g=f,o=u,d=h,L=c,P=l,K=p,V=_,J=b,I=O,C=A,W=N,F=G,M=m,j=0;j<al;j+=2)R=R+o|0,C^=R,C=C>>>32-16|C<<16,K=K+C|0,o^=K,o=o>>>32-12|o<<12,w=w+d|0,W^=w,W=W>>>32-16|W<<16,V=V+W|0,d^=V,d=d>>>32-12|d<<12,E=E+L|0,F^=E,F=F>>>32-16|F<<16,J=J+F|0,L^=J,L=L>>>32-12|L<<12,g=g+P|0,M^=g,M=M>>>32-16|M<<16,I=I+M|0,P^=I,P=P>>>32-12|P<<12,E=E+L|0,F^=E,F=F>>>32-8|F<<8,J=J+F|0,L^=J,L=L>>>32-7|L<<7,g=g+P|0,M^=g,M=M>>>32-8|M<<8,I=I+M|0,P^=I,P=P>>>32-7|P<<7,w=w+d|0,W^=w,W=W>>>32-8|W<<8,V=V+W|0,d^=V,d=d>>>32-7|d<<7,R=R+o|0,C^=R,C=C>>>32-8|C<<8,K=K+C|0,o^=K,o=o>>>32-7|o<<7,R=R+d|0,M^=R,M=M>>>32-16|M<<16,J=J+M|0,d^=J,d=d>>>32-12|d<<12,w=w+L|0,C^=w,C=C>>>32-16|C<<16,I=I+C|0,L^=I,L=L>>>32-12|L<<12,E=E+P|0,W^=E,W=W>>>32-16|W<<16,K=K+W|0,P^=K,P=P>>>32-12|P<<12,g=g+o|0,F^=g,F=F>>>32-16|F<<16,V=V+F|0,o^=V,o=o>>>32-12|o<<12,E=E+P|0,W^=E,W=W>>>32-8|W<<8,K=K+W|0,P^=K,P=P>>>32-7|P<<7,g=g+o|0,F^=g,F=F>>>32-8|F<<8,V=V+F|0,o^=V,o=o>>>32-7|o<<7,w=w+L|0,C^=w,C=C>>>32-8|C<<8,I=I+C|0,L^=I,L=L>>>32-7|L<<7,R=R+d|0,M^=R,M=M>>>32-8|M<<8,J=J+M|0,d^=J,d=d>>>32-7|d<<7;Ze.writeUint32LE(R+n|0,t,0),Ze.writeUint32LE(w+i|0,t,4),Ze.writeUint32LE(E+s|0,t,8),Ze.writeUint32LE(g+f|0,t,12),Ze.writeUint32LE(o+u|0,t,16),Ze.writeUint32LE(d+h|0,t,20),Ze.writeUint32LE(L+c|0,t,24),Ze.writeUint32LE(P+l|0,t,28),Ze.writeUint32LE(K+p|0,t,32),Ze.writeUint32LE(V+_|0,t,36),Ze.writeUint32LE(J+b|0,t,40),Ze.writeUint32LE(I+O|0,t,44),Ze.writeUint32LE(C+A|0,t,48),Ze.writeUint32LE(W+N|0,t,52),Ze.writeUint32LE(F+G|0,t,56),Ze.writeUint32LE(M+m|0,t,60)}function Cs(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,f;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),f=s.length-e.length,s.set(e,f)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,f=i}for(var u=new Uint8Array(64),h=0;h<r.length;h+=64){cl(u,s,t);for(var c=h;c<h+64&&c<r.length;c++)n[c]=r[c]^u[c-h];fl(s,0,f)}return $n.wipe(u),i===0&&$n.wipe(s),n}Fr.streamXOR=Cs;function ul(t,e,r,n){return n===void 0&&(n=0),$n.wipe(r),Cs(t,e,r,r,n)}Fr.stream=ul;function fl(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var As={},xt={};Object.defineProperty(xt,"__esModule",{value:!0});function hl(t,e,r){return~(t-1)&e|t-1&r}xt.select=hl;function ll(t,e){return(t|0)-(e|0)-1>>>31&1}xt.lessOrEqual=ll;function Ps(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}xt.compare=Ps;function dl(t,e){return t.length===0||e.length===0?!1:Ps(t,e)!==0}xt.equal=dl,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=xt,r=ct;t.DIGEST_LENGTH=16;var n=function(){function f(u){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=u[0]|u[1]<<8;this._r[0]=h&8191;var c=u[2]|u[3]<<8;this._r[1]=(h>>>13|c<<3)&8191;var l=u[4]|u[5]<<8;this._r[2]=(c>>>10|l<<6)&7939;var p=u[6]|u[7]<<8;this._r[3]=(l>>>7|p<<9)&8191;var _=u[8]|u[9]<<8;this._r[4]=(p>>>4|_<<12)&255,this._r[5]=_>>>1&8190;var b=u[10]|u[11]<<8;this._r[6]=(_>>>14|b<<2)&8191;var O=u[12]|u[13]<<8;this._r[7]=(b>>>11|O<<5)&8065;var A=u[14]|u[15]<<8;this._r[8]=(O>>>8|A<<8)&8191,this._r[9]=A>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return f.prototype._blocks=function(u,h,c){for(var l=this._fin?0:2048,p=this._h[0],_=this._h[1],b=this._h[2],O=this._h[3],A=this._h[4],N=this._h[5],G=this._h[6],m=this._h[7],R=this._h[8],w=this._h[9],E=this._r[0],g=this._r[1],o=this._r[2],d=this._r[3],L=this._r[4],P=this._r[5],K=this._r[6],V=this._r[7],J=this._r[8],I=this._r[9];c>=16;){var C=u[h+0]|u[h+1]<<8;p+=C&8191;var W=u[h+2]|u[h+3]<<8;_+=(C>>>13|W<<3)&8191;var F=u[h+4]|u[h+5]<<8;b+=(W>>>10|F<<6)&8191;var M=u[h+6]|u[h+7]<<8;O+=(F>>>7|M<<9)&8191;var j=u[h+8]|u[h+9]<<8;A+=(M>>>4|j<<12)&8191,N+=j>>>1&8191;var U=u[h+10]|u[h+11]<<8;G+=(j>>>14|U<<2)&8191;var B=u[h+12]|u[h+13]<<8;m+=(U>>>11|B<<5)&8191;var ee=u[h+14]|u[h+15]<<8;R+=(B>>>8|ee<<8)&8191,w+=ee>>>5|l;var z=0,Q=z;Q+=p*E,Q+=_*(5*I),Q+=b*(5*J),Q+=O*(5*V),Q+=A*(5*K),z=Q>>>13,Q&=8191,Q+=N*(5*P),Q+=G*(5*L),Q+=m*(5*d),Q+=R*(5*o),Q+=w*(5*g),z+=Q>>>13,Q&=8191;var k=z;k+=p*g,k+=_*E,k+=b*(5*I),k+=O*(5*J),k+=A*(5*V),z=k>>>13,k&=8191,k+=N*(5*K),k+=G*(5*P),k+=m*(5*L),k+=R*(5*d),k+=w*(5*o),z+=k>>>13,k&=8191;var Z=z;Z+=p*o,Z+=_*g,Z+=b*E,Z+=O*(5*I),Z+=A*(5*J),z=Z>>>13,Z&=8191,Z+=N*(5*V),Z+=G*(5*K),Z+=m*(5*P),Z+=R*(5*L),Z+=w*(5*d),z+=Z>>>13,Z&=8191;var x=z;x+=p*d,x+=_*o,x+=b*g,x+=O*E,x+=A*(5*I),z=x>>>13,x&=8191,x+=N*(5*J),x+=G*(5*V),x+=m*(5*K),x+=R*(5*P),x+=w*(5*L),z+=x>>>13,x&=8191;var T=z;T+=p*L,T+=_*d,T+=b*o,T+=O*g,T+=A*E,z=T>>>13,T&=8191,T+=N*(5*I),T+=G*(5*J),T+=m*(5*V),T+=R*(5*K),T+=w*(5*P),z+=T>>>13,T&=8191;var D=z;D+=p*P,D+=_*L,D+=b*d,D+=O*o,D+=A*g,z=D>>>13,D&=8191,D+=N*E,D+=G*(5*I),D+=m*(5*J),D+=R*(5*V),D+=w*(5*K),z+=D>>>13,D&=8191;var a=z;a+=p*K,a+=_*P,a+=b*L,a+=O*d,a+=A*o,z=a>>>13,a&=8191,a+=N*g,a+=G*E,a+=m*(5*I),a+=R*(5*J),a+=w*(5*V),z+=a>>>13,a&=8191;var v=z;v+=p*V,v+=_*K,v+=b*P,v+=O*L,v+=A*d,z=v>>>13,v&=8191,v+=N*o,v+=G*g,v+=m*E,v+=R*(5*I),v+=w*(5*J),z+=v>>>13,v&=8191;var H=z;H+=p*J,H+=_*V,H+=b*K,H+=O*P,H+=A*L,z=H>>>13,H&=8191,H+=N*d,H+=G*o,H+=m*g,H+=R*E,H+=w*(5*I),z+=H>>>13,H&=8191;var Y=z;Y+=p*I,Y+=_*J,Y+=b*V,Y+=O*K,Y+=A*P,z=Y>>>13,Y&=8191,Y+=N*L,Y+=G*d,Y+=m*o,Y+=R*g,Y+=w*E,z+=Y>>>13,Y&=8191,z=(z<<2)+z|0,z=z+Q|0,Q=z&8191,z=z>>>13,k+=z,p=Q,_=k,b=Z,O=x,A=T,N=D,G=a,m=v,R=H,w=Y,h+=16,c-=16}this._h[0]=p,this._h[1]=_,this._h[2]=b,this._h[3]=O,this._h[4]=A,this._h[5]=N,this._h[6]=G,this._h[7]=m,this._h[8]=R,this._h[9]=w},f.prototype.finish=function(u,h){h===void 0&&(h=0);var c=new Uint16Array(10),l,p,_,b;if(this._leftover){for(b=this._leftover,this._buffer[b++]=1;b<16;b++)this._buffer[b]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(l=this._h[1]>>>13,this._h[1]&=8191,b=2;b<10;b++)this._h[b]+=l,l=this._h[b]>>>13,this._h[b]&=8191;for(this._h[0]+=l*5,l=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=l,l=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=l,c[0]=this._h[0]+5,l=c[0]>>>13,c[0]&=8191,b=1;b<10;b++)c[b]=this._h[b]+l,l=c[b]>>>13,c[b]&=8191;for(c[9]-=8192,p=(l^1)-1,b=0;b<10;b++)c[b]&=p;for(p=~p,b=0;b<10;b++)this._h[b]=this._h[b]&p|c[b];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,_=this._h[0]+this._pad[0],this._h[0]=_&65535,b=1;b<8;b++)_=(this._h[b]+this._pad[b]|0)+(_>>>16)|0,this._h[b]=_&65535;return u[h+0]=this._h[0]>>>0,u[h+1]=this._h[0]>>>8,u[h+2]=this._h[1]>>>0,u[h+3]=this._h[1]>>>8,u[h+4]=this._h[2]>>>0,u[h+5]=this._h[2]>>>8,u[h+6]=this._h[3]>>>0,u[h+7]=this._h[3]>>>8,u[h+8]=this._h[4]>>>0,u[h+9]=this._h[4]>>>8,u[h+10]=this._h[5]>>>0,u[h+11]=this._h[5]>>>8,u[h+12]=this._h[6]>>>0,u[h+13]=this._h[6]>>>8,u[h+14]=this._h[7]>>>0,u[h+15]=this._h[7]>>>8,this._finished=!0,this},f.prototype.update=function(u){var h=0,c=u.length,l;if(this._leftover){l=16-this._leftover,l>c&&(l=c);for(var p=0;p<l;p++)this._buffer[this._leftover+p]=u[h+p];if(c-=l,h+=l,this._leftover+=l,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(c>=16&&(l=c-c%16,this._blocks(u,h,l),h+=l,c-=l),c){for(var p=0;p<c;p++)this._buffer[this._leftover+p]=u[h+p];this._leftover+=c}return this},f.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},f.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},f}();t.Poly1305=n;function i(f,u){var h=new n(f);h.update(u);var c=h.digest();return h.clean(),c}t.oneTimeAuth=i;function s(f,u){return f.length!==t.DIGEST_LENGTH||u.length!==t.DIGEST_LENGTH?!1:e.equal(f,u)}t.equal=s}(As),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Fr,r=As,n=ct,i=re,s=xt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var f=new Uint8Array(16),u=function(){function h(c){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,c.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(c)}return h.prototype.seal=function(c,l,p,_){if(c.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var b=new Uint8Array(16);b.set(c,b.length-c.length);var O=new Uint8Array(32);e.stream(this._key,b,O,4);var A=l.length+this.tagLength,N;if(_){if(_.length!==A)throw new Error("ChaCha20Poly1305: incorrect destination length");N=_}else N=new Uint8Array(A);return e.streamXOR(this._key,b,l,N,4),this._authenticate(N.subarray(N.length-this.tagLength,N.length),O,N.subarray(0,N.length-this.tagLength),p),n.wipe(b),N},h.prototype.open=function(c,l,p,_){if(c.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(l.length<this.tagLength)return null;var b=new Uint8Array(16);b.set(c,b.length-c.length);var O=new Uint8Array(32);e.stream(this._key,b,O,4);var A=new Uint8Array(this.tagLength);if(this._authenticate(A,O,l.subarray(0,l.length-this.tagLength),p),!s.equal(A,l.subarray(l.length-this.tagLength,l.length)))return null;var N=l.length-this.tagLength,G;if(_){if(_.length!==N)throw new Error("ChaCha20Poly1305: incorrect destination length");G=_}else G=new Uint8Array(N);return e.streamXOR(this._key,b,l.subarray(0,l.length-this.tagLength),G,4),n.wipe(b),G},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(c,l,p,_){var b=new r.Poly1305(l);_&&(b.update(_),_.length%16>0&&b.update(f.subarray(_.length%16))),b.update(p),p.length%16>0&&b.update(f.subarray(p.length%16));var O=new Uint8Array(8);_&&i.writeUint64LE(_.length,O),b.update(O),i.writeUint64LE(p.length,O),b.update(O);for(var A=b.digest(),N=0;N<A.length;N++)c[N]=A[N];b.clean(),n.wipe(A),n.wipe(O)},h}();t.ChaCha20Poly1305=u}(Mn);var Ls={},hr={},jn={};Object.defineProperty(jn,"__esModule",{value:!0});function gl(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}jn.isSerializableHash=gl,Object.defineProperty(hr,"__esModule",{value:!0});var wt=jn,yl=xt,_l=ct,Ns=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),wt.isSerializableHash(this._inner)&&wt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),_l.wipe(n)}return t.prototype.reset=function(){if(!wt.isSerializableHash(this._inner)||!wt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){wt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),wt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!wt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!wt.isSerializableHash(this._inner)||!wt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!wt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();hr.HMAC=Ns;function pl(t,e,r){var n=new Ns(t,e);n.update(r);var i=n.digest();return n.clean(),i}hr.hmac=pl,hr.equal=yl.equal,Object.defineProperty(Ls,"__esModule",{value:!0});var Us=hr,Ms=ct,bl=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=Us.hmac(this._hash,n,r);this._hmac=new Us.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Ms.wipe(this._buffer),Ms.wipe(this._counter),this._bufpos=0},t}(),vl=Ls.HKDF=bl,Br={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=ct;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(h,c){if(c===void 0&&(c=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var l=0;if(this._bytesHashed+=c,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&c>0;)this._buffer[this._bufferLength++]=h[l++],c--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(c>=this.blockSize&&(l=s(this._temp,this._state,h,l,c),c%=this.blockSize);c>0;)this._buffer[this._bufferLength++]=h[l++],c--;return this},u.prototype.finish=function(h){if(!this._finished){var c=this._bytesHashed,l=this._bufferLength,p=c/536870912|0,_=c<<3,b=c%64<56?64:128;this._buffer[l]=128;for(var O=l+1;O<b-8;O++)this._buffer[O]=0;e.writeUint32BE(p,this._buffer,b-8),e.writeUint32BE(_,this._buffer,b-4),s(this._temp,this._state,this._buffer,0,b),this._finished=!0}for(var O=0;O<this.digestLength/4;O++)e.writeUint32BE(this._state[O],h,O*4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(u,h,c,l,p){for(;p>=64;){for(var _=h[0],b=h[1],O=h[2],A=h[3],N=h[4],G=h[5],m=h[6],R=h[7],w=0;w<16;w++){var E=l+w*4;u[w]=e.readUint32BE(c,E)}for(var w=16;w<64;w++){var g=u[w-2],o=(g>>>17|g<<32-17)^(g>>>19|g<<32-19)^g>>>10;g=u[w-15];var d=(g>>>7|g<<32-7)^(g>>>18|g<<32-18)^g>>>3;u[w]=(o+u[w-7]|0)+(d+u[w-16]|0)}for(var w=0;w<64;w++){var o=(((N>>>6|N<<26)^(N>>>11|N<<21)^(N>>>25|N<<7))+(N&G^~N&m)|0)+(R+(i[w]+u[w]|0)|0)|0,d=((_>>>2|_<<32-2)^(_>>>13|_<<32-13)^(_>>>22|_<<32-22))+(_&b^_&O^b&O)|0;R=m,m=G,G=N,N=A+o|0,A=O,O=b,b=_,_=o+d|0}h[0]+=_,h[1]+=b,h[2]+=O,h[3]+=A,h[4]+=N,h[5]+=G,h[6]+=m,h[7]+=R,l+=64,p-=64}return l}function f(u){var h=new n;h.update(u);var c=h.digest();return h.clean(),c}t.hash=f})(Br);var Fn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=qt,r=ct;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(w){const E=new Float64Array(16);if(w)for(let g=0;g<w.length;g++)E[g]=w[g];return E}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function f(w){let E=1;for(let g=0;g<16;g++){let o=w[g]+E+65535;E=Math.floor(o/65536),w[g]=o-E*65536}w[0]+=E-1+37*(E-1)}function u(w,E,g){const o=~(g-1);for(let d=0;d<16;d++){const L=o&(w[d]^E[d]);w[d]^=L,E[d]^=L}}function h(w,E){const g=n(),o=n();for(let d=0;d<16;d++)o[d]=E[d];f(o),f(o),f(o);for(let d=0;d<2;d++){g[0]=o[0]-65517;for(let P=1;P<15;P++)g[P]=o[P]-65535-(g[P-1]>>16&1),g[P-1]&=65535;g[15]=o[15]-32767-(g[14]>>16&1);const L=g[15]>>16&1;g[14]&=65535,u(o,g,1-L)}for(let d=0;d<16;d++)w[2*d]=o[d]&255,w[2*d+1]=o[d]>>8}function c(w,E){for(let g=0;g<16;g++)w[g]=E[2*g]+(E[2*g+1]<<8);w[15]&=32767}function l(w,E,g){for(let o=0;o<16;o++)w[o]=E[o]+g[o]}function p(w,E,g){for(let o=0;o<16;o++)w[o]=E[o]-g[o]}function _(w,E,g){let o,d,L=0,P=0,K=0,V=0,J=0,I=0,C=0,W=0,F=0,M=0,j=0,U=0,B=0,ee=0,z=0,Q=0,k=0,Z=0,x=0,T=0,D=0,a=0,v=0,H=0,Y=0,he=0,pe=0,de=0,we=0,Ue=0,Ae=0,_e=g[0],ge=g[1],le=g[2],ue=g[3],ae=g[4],oe=g[5],se=g[6],te=g[7],fe=g[8],ye=g[9],ne=g[10],be=g[11],ve=g[12],me=g[13],De=g[14],Ee=g[15];o=E[0],L+=o*_e,P+=o*ge,K+=o*le,V+=o*ue,J+=o*ae,I+=o*oe,C+=o*se,W+=o*te,F+=o*fe,M+=o*ye,j+=o*ne,U+=o*be,B+=o*ve,ee+=o*me,z+=o*De,Q+=o*Ee,o=E[1],P+=o*_e,K+=o*ge,V+=o*le,J+=o*ue,I+=o*ae,C+=o*oe,W+=o*se,F+=o*te,M+=o*fe,j+=o*ye,U+=o*ne,B+=o*be,ee+=o*ve,z+=o*me,Q+=o*De,k+=o*Ee,o=E[2],K+=o*_e,V+=o*ge,J+=o*le,I+=o*ue,C+=o*ae,W+=o*oe,F+=o*se,M+=o*te,j+=o*fe,U+=o*ye,B+=o*ne,ee+=o*be,z+=o*ve,Q+=o*me,k+=o*De,Z+=o*Ee,o=E[3],V+=o*_e,J+=o*ge,I+=o*le,C+=o*ue,W+=o*ae,F+=o*oe,M+=o*se,j+=o*te,U+=o*fe,B+=o*ye,ee+=o*ne,z+=o*be,Q+=o*ve,k+=o*me,Z+=o*De,x+=o*Ee,o=E[4],J+=o*_e,I+=o*ge,C+=o*le,W+=o*ue,F+=o*ae,M+=o*oe,j+=o*se,U+=o*te,B+=o*fe,ee+=o*ye,z+=o*ne,Q+=o*be,k+=o*ve,Z+=o*me,x+=o*De,T+=o*Ee,o=E[5],I+=o*_e,C+=o*ge,W+=o*le,F+=o*ue,M+=o*ae,j+=o*oe,U+=o*se,B+=o*te,ee+=o*fe,z+=o*ye,Q+=o*ne,k+=o*be,Z+=o*ve,x+=o*me,T+=o*De,D+=o*Ee,o=E[6],C+=o*_e,W+=o*ge,F+=o*le,M+=o*ue,j+=o*ae,U+=o*oe,B+=o*se,ee+=o*te,z+=o*fe,Q+=o*ye,k+=o*ne,Z+=o*be,x+=o*ve,T+=o*me,D+=o*De,a+=o*Ee,o=E[7],W+=o*_e,F+=o*ge,M+=o*le,j+=o*ue,U+=o*ae,B+=o*oe,ee+=o*se,z+=o*te,Q+=o*fe,k+=o*ye,Z+=o*ne,x+=o*be,T+=o*ve,D+=o*me,a+=o*De,v+=o*Ee,o=E[8],F+=o*_e,M+=o*ge,j+=o*le,U+=o*ue,B+=o*ae,ee+=o*oe,z+=o*se,Q+=o*te,k+=o*fe,Z+=o*ye,x+=o*ne,T+=o*be,D+=o*ve,a+=o*me,v+=o*De,H+=o*Ee,o=E[9],M+=o*_e,j+=o*ge,U+=o*le,B+=o*ue,ee+=o*ae,z+=o*oe,Q+=o*se,k+=o*te,Z+=o*fe,x+=o*ye,T+=o*ne,D+=o*be,a+=o*ve,v+=o*me,H+=o*De,Y+=o*Ee,o=E[10],j+=o*_e,U+=o*ge,B+=o*le,ee+=o*ue,z+=o*ae,Q+=o*oe,k+=o*se,Z+=o*te,x+=o*fe,T+=o*ye,D+=o*ne,a+=o*be,v+=o*ve,H+=o*me,Y+=o*De,he+=o*Ee,o=E[11],U+=o*_e,B+=o*ge,ee+=o*le,z+=o*ue,Q+=o*ae,k+=o*oe,Z+=o*se,x+=o*te,T+=o*fe,D+=o*ye,a+=o*ne,v+=o*be,H+=o*ve,Y+=o*me,he+=o*De,pe+=o*Ee,o=E[12],B+=o*_e,ee+=o*ge,z+=o*le,Q+=o*ue,k+=o*ae,Z+=o*oe,x+=o*se,T+=o*te,D+=o*fe,a+=o*ye,v+=o*ne,H+=o*be,Y+=o*ve,he+=o*me,pe+=o*De,de+=o*Ee,o=E[13],ee+=o*_e,z+=o*ge,Q+=o*le,k+=o*ue,Z+=o*ae,x+=o*oe,T+=o*se,D+=o*te,a+=o*fe,v+=o*ye,H+=o*ne,Y+=o*be,he+=o*ve,pe+=o*me,de+=o*De,we+=o*Ee,o=E[14],z+=o*_e,Q+=o*ge,k+=o*le,Z+=o*ue,x+=o*ae,T+=o*oe,D+=o*se,a+=o*te,v+=o*fe,H+=o*ye,Y+=o*ne,he+=o*be,pe+=o*ve,de+=o*me,we+=o*De,Ue+=o*Ee,o=E[15],Q+=o*_e,k+=o*ge,Z+=o*le,x+=o*ue,T+=o*ae,D+=o*oe,a+=o*se,v+=o*te,H+=o*fe,Y+=o*ye,he+=o*ne,pe+=o*be,de+=o*ve,we+=o*me,Ue+=o*De,Ae+=o*Ee,L+=38*k,P+=38*Z,K+=38*x,V+=38*T,J+=38*D,I+=38*a,C+=38*v,W+=38*H,F+=38*Y,M+=38*he,j+=38*pe,U+=38*de,B+=38*we,ee+=38*Ue,z+=38*Ae,d=1,o=L+d+65535,d=Math.floor(o/65536),L=o-d*65536,o=P+d+65535,d=Math.floor(o/65536),P=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=V+d+65535,d=Math.floor(o/65536),V=o-d*65536,o=J+d+65535,d=Math.floor(o/65536),J=o-d*65536,o=I+d+65535,d=Math.floor(o/65536),I=o-d*65536,o=C+d+65535,d=Math.floor(o/65536),C=o-d*65536,o=W+d+65535,d=Math.floor(o/65536),W=o-d*65536,o=F+d+65535,d=Math.floor(o/65536),F=o-d*65536,o=M+d+65535,d=Math.floor(o/65536),M=o-d*65536,o=j+d+65535,d=Math.floor(o/65536),j=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=B+d+65535,d=Math.floor(o/65536),B=o-d*65536,o=ee+d+65535,d=Math.floor(o/65536),ee=o-d*65536,o=z+d+65535,d=Math.floor(o/65536),z=o-d*65536,o=Q+d+65535,d=Math.floor(o/65536),Q=o-d*65536,L+=d-1+37*(d-1),d=1,o=L+d+65535,d=Math.floor(o/65536),L=o-d*65536,o=P+d+65535,d=Math.floor(o/65536),P=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=V+d+65535,d=Math.floor(o/65536),V=o-d*65536,o=J+d+65535,d=Math.floor(o/65536),J=o-d*65536,o=I+d+65535,d=Math.floor(o/65536),I=o-d*65536,o=C+d+65535,d=Math.floor(o/65536),C=o-d*65536,o=W+d+65535,d=Math.floor(o/65536),W=o-d*65536,o=F+d+65535,d=Math.floor(o/65536),F=o-d*65536,o=M+d+65535,d=Math.floor(o/65536),M=o-d*65536,o=j+d+65535,d=Math.floor(o/65536),j=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=B+d+65535,d=Math.floor(o/65536),B=o-d*65536,o=ee+d+65535,d=Math.floor(o/65536),ee=o-d*65536,o=z+d+65535,d=Math.floor(o/65536),z=o-d*65536,o=Q+d+65535,d=Math.floor(o/65536),Q=o-d*65536,L+=d-1+37*(d-1),w[0]=L,w[1]=P,w[2]=K,w[3]=V,w[4]=J,w[5]=I,w[6]=C,w[7]=W,w[8]=F,w[9]=M,w[10]=j,w[11]=U,w[12]=B,w[13]=ee,w[14]=z,w[15]=Q}function b(w,E){_(w,E,E)}function O(w,E){const g=n();for(let o=0;o<16;o++)g[o]=E[o];for(let o=253;o>=0;o--)b(g,g),o!==2&&o!==4&&_(g,g,E);for(let o=0;o<16;o++)w[o]=g[o]}function A(w,E){const g=new Uint8Array(32),o=new Float64Array(80),d=n(),L=n(),P=n(),K=n(),V=n(),J=n();for(let F=0;F<31;F++)g[F]=w[F];g[31]=w[31]&127|64,g[0]&=248,c(o,E);for(let F=0;F<16;F++)L[F]=o[F];d[0]=K[0]=1;for(let F=254;F>=0;--F){const M=g[F>>>3]>>>(F&7)&1;u(d,L,M),u(P,K,M),l(V,d,P),p(d,d,P),l(P,L,K),p(L,L,K),b(K,V),b(J,d),_(d,P,d),_(P,L,V),l(V,d,P),p(d,d,P),b(L,d),p(P,K,J),_(d,P,s),l(d,d,K),_(P,P,d),_(d,K,J),_(K,L,o),b(L,V),u(d,L,M),u(P,K,M)}for(let F=0;F<16;F++)o[F+16]=d[F],o[F+32]=P[F],o[F+48]=L[F],o[F+64]=K[F];const I=o.subarray(32),C=o.subarray(16);O(I,I),_(C,C,I);const W=new Uint8Array(32);return h(W,C),W}t.scalarMult=A;function N(w){return A(w,i)}t.scalarMultBase=N;function G(w){if(w.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const E=new Uint8Array(w);return{publicKey:N(E),secretKey:E}}t.generateKeyPairFromSeed=G;function m(w){const E=(0,e.randomBytes)(32,w),g=G(E);return(0,r.wipe)(E),g}t.generateKeyPair=m;function R(w,E,g=!1){if(w.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(E.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=A(w,E);if(g){let d=0;for(let L=0;L<o.length;L++)d|=o[L];if(d===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=R})(Fn);var $s=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},wl=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),El=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),ml=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),Dl=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Sl=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Ol=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Il=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,js=3,Tl=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Ol]],Fs=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function xl(t){return t?Bs(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Sl:typeof navigator<"u"?Bs(navigator.userAgent):Al()}function Rl(t){return t!==""&&Tl.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function Bs(t){var e=Rl(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new Dl;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<js&&(i=$s($s([],i,!0),Pl(js-i.length),!0)):i=[];var s=i.join("."),f=Cl(t),u=Il.exec(t);return u&&u[1]?new ml(r,s,f,u[1]):new wl(r,s,f)}function Cl(t){for(var e=0,r=Fs.length;e<r;e++){var n=Fs[e],i=n[0],s=n[1],f=s.exec(t);if(f)return i}return null}function Al(){var t=typeof process<"u"&&process.version;return t?new El(process.version.slice(1)):null}function Pl(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Te={};Object.defineProperty(Te,"__esModule",{value:!0}),Te.getLocalStorage=Te.getLocalStorageOrThrow=Te.getCrypto=Te.getCryptoOrThrow=Ks=Te.getLocation=Te.getLocationOrThrow=Bn=Te.getNavigator=Te.getNavigatorOrThrow=zs=Te.getDocument=Te.getDocumentOrThrow=Te.getFromWindowOrThrow=Te.getFromWindow=void 0;function Ft(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Te.getFromWindow=Ft;function kt(t){const e=Ft(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Te.getFromWindowOrThrow=kt;function Ll(){return kt("document")}Te.getDocumentOrThrow=Ll;function Nl(){return Ft("document")}var zs=Te.getDocument=Nl;function Ul(){return kt("navigator")}Te.getNavigatorOrThrow=Ul;function Ml(){return Ft("navigator")}var Bn=Te.getNavigator=Ml;function $l(){return kt("location")}Te.getLocationOrThrow=$l;function jl(){return Ft("location")}var Ks=Te.getLocation=jl;function Fl(){return kt("crypto")}Te.getCryptoOrThrow=Fl;function Bl(){return Ft("crypto")}Te.getCrypto=Bl;function zl(){return kt("localStorage")}Te.getLocalStorageOrThrow=zl;function Kl(){return Ft("localStorage")}Te.getLocalStorage=Kl;var zn={};Object.defineProperty(zn,"__esModule",{value:!0}),zn.getWindowMetadata=void 0;const Hs=Te;function Hl(){let t,e;try{t=Hs.getDocumentOrThrow(),e=Hs.getLocationOrThrow()}catch{return null}function r(){const p=t.getElementsByTagName("link"),_=[];for(let b=0;b<p.length;b++){const O=p[b],A=O.getAttribute("rel");if(A&&A.toLowerCase().indexOf("icon")>-1){const N=O.getAttribute("href");if(N)if(N.toLowerCase().indexOf("https:")===-1&&N.toLowerCase().indexOf("http:")===-1&&N.indexOf("//")!==0){let G=e.protocol+"//"+e.host;if(N.indexOf("/")===0)G+=N;else{const m=e.pathname.split("/");m.pop();const R=m.join("/");G+=R+"/"+N}_.push(G)}else if(N.indexOf("//")===0){const G=e.protocol+N;_.push(G)}else _.push(N)}}return _}function n(...p){const _=t.getElementsByTagName("meta");for(let b=0;b<_.length;b++){const O=_[b],A=["itemprop","property","name"].map(N=>O.getAttribute(N)).filter(N=>N?p.includes(N):!1);if(A.length&&A){const N=O.getAttribute("content");if(N)return N}}return""}function i(){let p=n("name","og:site_name","og:title","twitter:title");return p||(p=t.title),p}function s(){return n("description","og:description","twitter:description","keywords")}const f=i(),u=s(),h=e.origin,c=r();return{description:u,url:h,icons:c,name:f}}zn.getWindowMetadata=Hl;var lr={},Gl=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Gs="%[a-f0-9]{2}",Vs=new RegExp("("+Gs+")|([^%]+?)","gi"),Ws=new RegExp("("+Gs+")+","gi");function Kn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],Kn(r),Kn(n))}function Vl(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Vs)||[],r=1;r<e.length;r++)t=Kn(e,r).join(""),e=t.match(Vs)||[];return t}}function Wl(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Ws.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=Vl(r[0]);n!==r[0]&&(e[r[0]]=n)}r=Ws.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),s=0;s<i.length;s++){var f=i[s];t=t.replace(new RegExp(f,"g"),e[f])}return t}var Yl=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Wl(t)}},ql=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},kl=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),s=0;s<n.length;s++){var f=n[s],u=t[f];(i?e.indexOf(f)!==-1:e(f,u,t))&&(r[f]=u)}return r};(function(t){const e=Gl,r=Yl,n=ql,i=kl,s=m=>m==null,f=Symbol("encodeFragmentIdentifier");function u(m){switch(m.arrayFormat){case"index":return R=>(w,E)=>{const g=w.length;return E===void 0||m.skipNull&&E===null||m.skipEmptyString&&E===""?w:E===null?[...w,[l(R,m),"[",g,"]"].join("")]:[...w,[l(R,m),"[",l(g,m),"]=",l(E,m)].join("")]};case"bracket":return R=>(w,E)=>E===void 0||m.skipNull&&E===null||m.skipEmptyString&&E===""?w:E===null?[...w,[l(R,m),"[]"].join("")]:[...w,[l(R,m),"[]=",l(E,m)].join("")];case"colon-list-separator":return R=>(w,E)=>E===void 0||m.skipNull&&E===null||m.skipEmptyString&&E===""?w:E===null?[...w,[l(R,m),":list="].join("")]:[...w,[l(R,m),":list=",l(E,m)].join("")];case"comma":case"separator":case"bracket-separator":{const R=m.arrayFormat==="bracket-separator"?"[]=":"=";return w=>(E,g)=>g===void 0||m.skipNull&&g===null||m.skipEmptyString&&g===""?E:(g=g===null?"":g,E.length===0?[[l(w,m),R,l(g,m)].join("")]:[[E,l(g,m)].join(m.arrayFormatSeparator)])}default:return R=>(w,E)=>E===void 0||m.skipNull&&E===null||m.skipEmptyString&&E===""?w:E===null?[...w,l(R,m)]:[...w,[l(R,m),"=",l(E,m)].join("")]}}function h(m){let R;switch(m.arrayFormat){case"index":return(w,E,g)=>{if(R=/\[(\d*)\]$/.exec(w),w=w.replace(/\[\d*\]$/,""),!R){g[w]=E;return}g[w]===void 0&&(g[w]={}),g[w][R[1]]=E};case"bracket":return(w,E,g)=>{if(R=/(\[\])$/.exec(w),w=w.replace(/\[\]$/,""),!R){g[w]=E;return}if(g[w]===void 0){g[w]=[E];return}g[w]=[].concat(g[w],E)};case"colon-list-separator":return(w,E,g)=>{if(R=/(:list)$/.exec(w),w=w.replace(/:list$/,""),!R){g[w]=E;return}if(g[w]===void 0){g[w]=[E];return}g[w]=[].concat(g[w],E)};case"comma":case"separator":return(w,E,g)=>{const o=typeof E=="string"&&E.includes(m.arrayFormatSeparator),d=typeof E=="string"&&!o&&p(E,m).includes(m.arrayFormatSeparator);E=d?p(E,m):E;const L=o||d?E.split(m.arrayFormatSeparator).map(P=>p(P,m)):E===null?E:p(E,m);g[w]=L};case"bracket-separator":return(w,E,g)=>{const o=/(\[\])$/.test(w);if(w=w.replace(/\[\]$/,""),!o){g[w]=E&&p(E,m);return}const d=E===null?[]:E.split(m.arrayFormatSeparator).map(L=>p(L,m));if(g[w]===void 0){g[w]=d;return}g[w]=[].concat(g[w],d)};default:return(w,E,g)=>{if(g[w]===void 0){g[w]=E;return}g[w]=[].concat(g[w],E)}}}function c(m){if(typeof m!="string"||m.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function l(m,R){return R.encode?R.strict?e(m):encodeURIComponent(m):m}function p(m,R){return R.decode?r(m):m}function _(m){return Array.isArray(m)?m.sort():typeof m=="object"?_(Object.keys(m)).sort((R,w)=>Number(R)-Number(w)).map(R=>m[R]):m}function b(m){const R=m.indexOf("#");return R!==-1&&(m=m.slice(0,R)),m}function O(m){let R="";const w=m.indexOf("#");return w!==-1&&(R=m.slice(w)),R}function A(m){m=b(m);const R=m.indexOf("?");return R===-1?"":m.slice(R+1)}function N(m,R){return R.parseNumbers&&!Number.isNaN(Number(m))&&typeof m=="string"&&m.trim()!==""?m=Number(m):R.parseBooleans&&m!==null&&(m.toLowerCase()==="true"||m.toLowerCase()==="false")&&(m=m.toLowerCase()==="true"),m}function G(m,R){R=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},R),c(R.arrayFormatSeparator);const w=h(R),E=Object.create(null);if(typeof m!="string"||(m=m.trim().replace(/^[?#&]/,""),!m))return E;for(const g of m.split("&")){if(g==="")continue;let[o,d]=n(R.decode?g.replace(/\+/g," "):g,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(R.arrayFormat)?d:p(d,R),w(p(o,R),d,E)}for(const g of Object.keys(E)){const o=E[g];if(typeof o=="object"&&o!==null)for(const d of Object.keys(o))o[d]=N(o[d],R);else E[g]=N(o,R)}return R.sort===!1?E:(R.sort===!0?Object.keys(E).sort():Object.keys(E).sort(R.sort)).reduce((g,o)=>{const d=E[o];return d&&typeof d=="object"&&!Array.isArray(d)?g[o]=_(d):g[o]=d,g},Object.create(null))}t.extract=A,t.parse=G,t.stringify=(m,R)=>{if(!m)return"";R=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},R),c(R.arrayFormatSeparator);const w=d=>R.skipNull&&s(m[d])||R.skipEmptyString&&m[d]==="",E=u(R),g={};for(const d of Object.keys(m))w(d)||(g[d]=m[d]);const o=Object.keys(g);return R.sort!==!1&&o.sort(R.sort),o.map(d=>{const L=m[d];return L===void 0?"":L===null?l(d,R):Array.isArray(L)?L.length===0&&R.arrayFormat==="bracket-separator"?l(d,R)+"[]":L.reduce(E(d),[]).join("&"):l(d,R)+"="+l(L,R)}).filter(d=>d.length>0).join("&")},t.parseUrl=(m,R)=>{R=Object.assign({decode:!0},R);const[w,E]=n(m,"#");return Object.assign({url:w.split("?")[0]||"",query:G(A(m),R)},R&&R.parseFragmentIdentifier&&E?{fragmentIdentifier:p(E,R)}:{})},t.stringifyUrl=(m,R)=>{R=Object.assign({encode:!0,strict:!0,[f]:!0},R);const w=b(m.url).split("?")[0]||"",E=t.extract(m.url),g=t.parse(E,{sort:!1}),o=Object.assign(g,m.query);let d=t.stringify(o,R);d&&(d=`?${d}`);let L=O(m.url);return m.fragmentIdentifier&&(L=`#${R[f]?l(m.fragmentIdentifier,R):m.fragmentIdentifier}`),`${w}${d}${L}`},t.pick=(m,R,w)=>{w=Object.assign({parseFragmentIdentifier:!0,[f]:!1},w);const{url:E,query:g,fragmentIdentifier:o}=t.parseUrl(m,w);return t.stringifyUrl({url:E,query:i(g,R),fragmentIdentifier:o},w)},t.exclude=(m,R,w)=>{const E=Array.isArray(R)?g=>!R.includes(g):(g,o)=>!R(g,o);return t.pick(m,E,w)}})(lr);const Xl={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Ys="base10",it="base16",Hn="base64pad",Gn="utf8",qs=0,Xt=1,Jl=0,ks=1,Vn=12,Wn=32;function Ql(){const t=Fn.generateKeyPair();return{privateKey:rt(t.secretKey,it),publicKey:rt(t.publicKey,it)}}function Yn(){const t=qt.randomBytes(Wn);return rt(t,it)}function Zl(t,e){const r=Fn.sharedKey(nt(t,it),nt(e,it),!0),n=new vl(Br.SHA256,r).expand(Wn);return rt(n,it)}function ed(t){const e=Br.hash(nt(t,it));return rt(e,it)}function qn(t){const e=Br.hash(nt(t,Gn));return rt(e,it)}function td(t){return nt(`${t}`,Ys)}function dr(t){return Number(rt(t,Ys))}function rd(t){const e=td(typeof t.type<"u"?t.type:qs);if(dr(e)===Xt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?nt(t.senderPublicKey,it):void 0,n=typeof t.iv<"u"?nt(t.iv,it):qt.randomBytes(Vn),i=new Mn.ChaCha20Poly1305(nt(t.symKey,it)).seal(n,nt(t.message,Gn));return id({type:e,sealed:i,iv:n,senderPublicKey:r})}function nd(t){const e=new Mn.ChaCha20Poly1305(nt(t.symKey,it)),{sealed:r,iv:n}=zr(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return rt(i,Gn)}function id(t){if(dr(t.type)===Xt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return rt(Pn([t.type,t.senderPublicKey,t.iv,t.sealed]),Hn)}return rt(Pn([t.type,t.iv,t.sealed]),Hn)}function zr(t){const e=nt(t,Hn),r=e.slice(Jl,ks),n=ks;if(dr(r)===Xt){const u=n+Wn,h=u+Vn,c=e.slice(n,u),l=e.slice(u,h),p=e.slice(h);return{type:r,sealed:p,iv:l,senderPublicKey:c}}const i=n+Vn,s=e.slice(n,i),f=e.slice(i);return{type:r,sealed:f,iv:s}}function sd(t,e){const r=zr(t);return Xs({type:dr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?rt(r.senderPublicKey,it):void 0,receiverPublicKey:e?.receiverPublicKey})}function Xs(t){const e=t?.type||qs;if(e===Xt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Js(t){return t.type===Xt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var od=Object.defineProperty,Qs=Object.getOwnPropertySymbols,ad=Object.prototype.hasOwnProperty,cd=Object.prototype.propertyIsEnumerable,Zs=(t,e,r)=>e in t?od(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,eo=(t,e)=>{for(var r in e||(e={}))ad.call(e,r)&&Zs(t,r,e[r]);if(Qs)for(var r of Qs(e))cd.call(e,r)&&Zs(t,r,e[r]);return t};const ud="ReactNative",_t={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},fd="js";function kn(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Jt(){return!zs()&&!!Bn()&&navigator.product===ud}function Kr(){return!kn()&&!!Bn()}function Hr(){return Jt()?_t.reactNative:kn()?_t.node:Kr()?_t.browser:_t.unknown}function hd(){var t;try{return Jt()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function ld(t,e){let r=lr.parse(t);return r=eo(eo({},r),e),t=lr.stringify(r),t}function dd(){if(Hr()===_t.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=xl();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function gd(){var t;const e=Hr();return e===_t.browser?[e,((t=Ks())==null?void 0:t.host)||"unknown"].join(":"):e}function yd(t,e,r){const n=dd(),i=gd();return[[t,e].join("-"),[fd,r].join("-"),n,i].join("/")}function _d({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:f,bundleId:u}){const h=r.split("?"),c=yd(t,e,n),l={auth:i,ua:c,projectId:s,useOnCloseEvent:f||void 0,origin:u||void 0},p=ld(h[1]||"",l);return h[0]+"?"+p}function to(t){return Object.fromEntries(t.entries())}function ro(t){return new Map(Object.entries(t))}function pd(t=ce.FIVE_MINUTES,e){const r=ce.toMiliseconds(t||ce.FIVE_MINUTES);let n,i,s;return{resolve:f=>{s&&n&&(clearTimeout(s),n(f))},reject:f=>{s&&i&&(clearTimeout(s),i(f))},done:()=>new Promise((f,u)=>{s=setTimeout(()=>{u(new Error(e))},r),n=f,i=u})}}function gr(t,e,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),e);try{const f=await t;n(f)}catch(f){i(f)}clearTimeout(s)})}function no(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function bd(t){return no("topic",t)}function vd(t){return no("id",t)}function wd(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Gr(t,e){return ce.fromMiliseconds((e||Date.now())+ce.toMiliseconds(t))}function io(t){return Date.now()>=ce.toMiliseconds(t)}function Xn(t,e){return`${t}${e?`:${e}`:""}`}const Ed="irn";function Jn(t){return t?.relay||{protocol:Ed}}function Vr(t){const e=Xl[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var md=Object.defineProperty,so=Object.getOwnPropertySymbols,Dd=Object.prototype.hasOwnProperty,Sd=Object.prototype.propertyIsEnumerable,oo=(t,e,r)=>e in t?md(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Od=(t,e)=>{for(var r in e||(e={}))Dd.call(e,r)&&oo(t,r,e[r]);if(so)for(var r of so(e))Sd.call(e,r)&&oo(t,r,e[r]);return t};function Id(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),f=t[i];r[s]=f}}),r}function ao(t){t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",f=lr.parse(s);return{protocol:n,topic:Td(i[0]),version:parseInt(i[1],10),symKey:f.symKey,relay:Id(f)}}function Td(t){return t.startsWith("//")?t.substring(2):t}function xd(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=r+e+i;t[i]&&(n[s]=t[i])}),n}function Rd(t){return`${t.protocol}:${t.topic}@${t.version}?`+lr.stringify(Od({symKey:t.symKey},xd(t.relay)))}const Cd={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ad={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Ie(t,e){const{message:r,code:n}=Ad[t];return{message:e?`${r} ${e}`:r,code:n}}function yr(t,e){const{message:r,code:n}=Cd[t];return{message:e?`${r} ${e}`:r,code:n}}function Pd(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Wr(t){return typeof t>"u"}function co(t,e){return e&&Wr(t)?!0:typeof t=="string"&&!!t.trim().length}function Ld(t){if(co(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Nd(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Ud(t){return t?.topic}function Qn(t){return typeof t<"u"&&typeof t!==null}function uo(){const t=Hr();return new Promise(e=>{switch(t){case _t.browser:e(Md());break;case _t.reactNative:e($d());break;case _t.node:e(jd());break;default:e(!0)}})}function Md(){return Kr()&&navigator?.onLine}async function $d(){if(Jt()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t?.isConnected}return!0}function jd(){return!0}function Fd(t){switch(Hr()){case _t.browser:Bd(t);break;case _t.reactNative:zd(t);break}}function Bd(t){!Jt()&&Kr()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function zd(t){Jt()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}const Zn="wc",fo=2,Yr="core",Dt=`${Zn}@2:${Yr}:`,ho={name:Yr,logger:"error"},lo={database:":memory:"},go="crypto",ei="client_ed25519_seed",yo=ce.ONE_DAY,_o="keychain",po="0.3",bo="messages",vo="0.3",wo=ce.SIX_HOURS,Eo="publisher",mo="irn",Do="error",ti="wss://relay.walletconnect.com",ri="wss://relay.walletconnect.org",So="relayer",st={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Oo="_subscription",Et={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Io=ce.ONE_SECOND,Kd={database:":memory:"},To="2.10.6",xo=1e4,Ro="0.3",Co="WALLETCONNECT_CLIENT_ID",lt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Hd=ce.THIRTY_DAYS,Ao="subscription",Po="0.3",Lo=ce.FIVE_SECONDS*1e3,No="pairing",Uo="0.3",Gd=ce.THIRTY_DAYS,Qt={wc_pairingDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:0},res:{ttl:ce.ONE_DAY,prompt:!1,tag:0}}},_r={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},pt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Mo="history",$o="0.3",jo="expirer",dt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Fo="0.3",Vd=ce.ONE_DAY,qr="verify-api",Zt="https://verify.walletconnect.com",kr="https://verify.walletconnect.org",Bo=[Zt,kr];class zo{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=_o,this.version=po,this.initialized=!1,this.storagePrefix=Dt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=Ie("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,to(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ro(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Ie("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ko{constructor(e,r,n){this.core=e,this.logger=r,this.name=go,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Rs(i);return xs(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=Ql();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),f=Rs(s),u=Yn();return await ol(u,i,yo,f)},this.generateSharedKey=(i,s,f)=>{this.isInitialized();const u=this.getPrivateKey(i),h=Zl(u,s);return this.setSymKey(h,f)},this.setSymKey=async(i,s)=>{this.isInitialized();const f=s||ed(i);return await this.keychain.set(f,i),f},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,f)=>{this.isInitialized();const u=Xs(f),h=rr(s);if(Js(u)){const _=u.senderPublicKey,b=u.receiverPublicKey;i=await this.generateSharedKey(_,b)}const c=this.getSymKey(i),{type:l,senderPublicKey:p}=u;return rd({type:l,symKey:c,message:h,senderPublicKey:p})},this.decode=async(i,s,f)=>{this.isInitialized();const u=sd(s,f);if(Js(u)){const h=u.receiverPublicKey,c=u.senderPublicKey;i=await this.generateSharedKey(h,c)}try{const h=this.getSymKey(i),c=nd({symKey:h,encoded:s});return xr(c)}catch(h){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(h)}},this.getPayloadType=i=>{const s=zr(i);return dr(s.type)},this.getPayloadSenderPublicKey=i=>{const s=zr(i);return s.senderPublicKey?rt(s.senderPublicKey,it):void 0},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.keychain=n||new zo(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(ei)}catch{e=Yn(),await this.keychain.set(ei,e)}return nt(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Ie("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ho extends Hu{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=bo,this.version=vo,this.initialized=!1,this.storagePrefix=Dt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=qn(i);let f=this.messages.get(n);return typeof f>"u"&&(f={}),typeof f[s]<"u"||(f[s]=i,this.messages.set(n,f),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),f=qn(i);return typeof s[f]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=r}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,to(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ro(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Ie("NOT_INITIALIZED",this.name);throw new Error(e)}}}const Wd="PARSE_ERROR",Yd="INVALID_REQUEST",qd="METHOD_NOT_FOUND",kd="INVALID_PARAMS",Go="INTERNAL_ERROR",ni="SERVER_ERROR",Xd=[-32700,-32600,-32601,-32602,-32603],pr={[Wd]:{code:-32700,message:"Parse error"},[Yd]:{code:-32600,message:"Invalid Request"},[qd]:{code:-32601,message:"Method not found"},[kd]:{code:-32602,message:"Invalid params"},[Go]:{code:-32603,message:"Internal error"},[ni]:{code:-32e3,message:"Server error"}},Vo=ni;function Jd(t){return Xd.includes(t)}function Wo(t){return Object.keys(pr).includes(t)?pr[t]:pr[Vo]}function Qd(t){const e=Object.values(pr).find(r=>r.code===t);return e||pr[Vo]}function Zd(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Yo={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ii=function(t,e){return ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ii(t,e)};function eg(t,e){ii(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var si=function(){return si=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},si.apply(this,arguments)};function tg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function rg(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(f=t[u])&&(s=(i<3?f(s):i>3?f(e,r,s):f(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function ng(t,e){return function(r,n){e(r,n,t)}}function ig(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function sg(t,e,r,n){function i(s){return s instanceof r?s:new r(function(f){f(s)})}return new(r||(r=Promise))(function(s,f){function u(l){try{c(n.next(l))}catch(p){f(p)}}function h(l){try{c(n.throw(l))}catch(p){f(p)}}function c(l){l.done?s(l.value):i(l.value).then(u,h)}c((n=n.apply(t,e||[])).next())})}function og(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,f;return f={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function u(c){return function(l){return h([c,l])}}function h(c){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){r.label=c[1];break}if(c[0]===6&&r.label<s[1]){r.label=s[1],s=c;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(c);break}s[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(l){c=[6,l],i=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function ag(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function cg(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function oi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qo(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],f;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){f={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return s}function ug(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(qo(arguments[e]));return t}function fg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],f=0,u=s.length;f<u;f++,i++)n[i]=s[f];return n}function br(t){return this instanceof br?(this.v=t,this):new br(t)}function hg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},f("next"),f("throw"),f("return"),i[Symbol.asyncIterator]=function(){return this},i;function f(_){n[_]&&(i[_]=function(b){return new Promise(function(O,A){s.push([_,b,O,A])>1||u(_,b)})})}function u(_,b){try{h(n[_](b))}catch(O){p(s[0][3],O)}}function h(_){_.value instanceof br?Promise.resolve(_.value.v).then(c,l):p(s[0][2],_)}function c(_){u("next",_)}function l(_){u("throw",_)}function p(_,b){_(b),s.shift(),s.length&&u(s[0][0],s[0][1])}}function lg(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(f){return(r=!r)?{value:br(t[i](f)),done:i==="return"}:s?s(f):f}:s}}function dg(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof oi=="function"?oi(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(f){return new Promise(function(u,h){f=t[s](f),i(u,h,f.done,f.value)})}}function i(s,f,u,h){Promise.resolve(h).then(function(c){s({value:c,done:u})},f)}}function gg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function yg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function _g(t){return t&&t.__esModule?t:{default:t}}function pg(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function bg(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var vg=Object.freeze({__proto__:null,__extends:eg,get __assign(){return si},__rest:tg,__decorate:rg,__param:ng,__metadata:ig,__awaiter:sg,__generator:og,__createBinding:ag,__exportStar:cg,__values:oi,__read:qo,__spread:ug,__spreadArrays:fg,__await:br,__asyncGenerator:hg,__asyncDelegator:lg,__asyncValues:dg,__makeTemplateObject:gg,__importStar:yg,__importDefault:_g,__classPrivateFieldGet:pg,__classPrivateFieldSet:bg}),wg=Gt(vg),St={},ko;function Eg(){if(ko)return St;ko=1,Object.defineProperty(St,"__esModule",{value:!0}),St.isBrowserCryptoAvailable=St.getSubtleCrypto=St.getBrowerCrypto=void 0;function t(){return ot?.crypto||ot?.msCrypto||{}}St.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}St.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return St.isBrowserCryptoAvailable=r,St}var Ot={},Xo;function mg(){if(Xo)return Ot;Xo=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.isBrowser=Ot.isNode=Ot.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Ot.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Ot.isNode=e;function r(){return!t()&&!e()}return Ot.isBrowser=r,Ot}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=wg;e.__exportStar(Eg(),t),e.__exportStar(mg(),t)})(Yo);function Jo(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Qo(t=6){return BigInt(Jo(t))}function ai(t,e,r){return{id:r||Jo(),jsonrpc:"2.0",method:t,params:e}}function Zo(t,e){return{id:t,jsonrpc:"2.0",result:e}}function ea(t,e,r){return{id:t,jsonrpc:"2.0",error:Dg(e,r)}}function Dg(t,e){return typeof t>"u"?Wo(Go):(typeof t=="string"&&(t=Object.assign(Object.assign({},Wo(ni)),{message:t})),typeof e<"u"&&(t.data=e),Jd(t.code)&&(t=Qd(t.code)),t)}class Sg{}class Og extends Sg{constructor(){super()}}class Ig extends Og{constructor(e){super()}}const Tg="^wss?:";function xg(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Rg(t,e){const r=xg(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function ta(t){return Rg(t,Tg)}function Cg(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function ra(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function na(t){return ra(t)&&"method"in t}function ci(t){return ra(t)&&(ia(t)||Xr(t))}function ia(t){return"result"in t}function Xr(t){return"error"in t}class Ag extends Ig{constructor(e){super(e),this.events=new ht.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(ai(e.method,e.params||[],e.id||Qo().toString()),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{Xr(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ci(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Pg=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Lg=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",sa=t=>t.split("?")[0],oa=10,Ng=Pg();class Ug{constructor(e){if(this.url=e,this.events=new ht.exports.EventEmitter,this.registering=!1,!ta(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(rr(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!ta(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=new URLSearchParams(e).get("origin"),s=Yo.isReactNative()?{headers:{origin:i}}:{rejectUnauthorized:!Cg(e)},f=new Ng(e,[],s);Lg()?f.onerror=u=>{const h=u;n(this.emitError(h.error))}:f.on("error",u=>{n(this.emitError(u))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?xr(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=ea(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return Zd(e,sa(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>oa&&this.events.setMaxListeners(oa)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${sa(this.url)}`));return this.events.emit("register_error",r),r}}class Mg extends Gu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ht.exports.EventEmitter,this.name=Eo,this.queue=new Map,this.publishTimeout=ce.toMiliseconds(ce.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,i,s)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const u=s?.ttl||wo,h=Jn(s),c=s?.prompt||!1,l=s?.tag||0,p=s?.id||Qo().toString(),_={topic:n,message:i,opts:{ttl:u,relay:h,prompt:c,tag:l,id:p}},b=setTimeout(()=>this.queue.set(p,_),this.publishTimeout);try{await await gr(this.rpcPublish(n,i,u,h,c,l,p),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(p),this.relayer.events.emit(st.publish,_)}catch(O){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=s?.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(p),O;return}finally{clearTimeout(b)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(u){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(u),u}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,s,f,u){var h,c,l,p;const _={method:Vr(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:s,tag:f},id:u};return Wr((h=_.params)==null?void 0:h.prompt)&&((c=_.params)==null||delete c.prompt),Wr((l=_.params)==null?void 0:l.tag)&&((p=_.params)==null||delete p.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:_}),this.relayer.request(_)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:i}=e;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(Wt.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(st.connection_stalled);return}this.checkQueue()}),this.relayer.on(st.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class $g{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var jg=Object.defineProperty,Fg=Object.defineProperties,Bg=Object.getOwnPropertyDescriptors,aa=Object.getOwnPropertySymbols,zg=Object.prototype.hasOwnProperty,Kg=Object.prototype.propertyIsEnumerable,ca=(t,e,r)=>e in t?jg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vr=(t,e)=>{for(var r in e||(e={}))zg.call(e,r)&&ca(t,r,e[r]);if(aa)for(var r of aa(e))Kg.call(e,r)&&ca(t,r,e[r]);return t},ui=(t,e)=>Fg(t,Bg(e));class ua extends Yu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new $g,this.events=new ht.exports.EventEmitter,this.name=Ao,this.version=Po,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Dt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=Jn(i),f={topic:n,relay:s};this.pending.set(n,f);const u=await this.rpcSubscribe(n,s);return this.onSubscribe(u,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),u}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const f=new ce.Watch;f.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(u),f.stop(this.pendingSubscriptionWatchLabel),i(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=Lo&&(clearInterval(u),f.stop(this.pendingSubscriptionWatchLabel),s(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=Jn(n);await this.rpcUnsubscribe(e,r,i);const s=yr("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:Vr(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await gr(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(st.connection_stalled)}return qn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:Vr(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await gr(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(st.connection_stalled)}}rpcUnsubscribe(e,r,n){const i={method:Vr(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,r){this.setSubscription(e,ui(vr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,vr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,vr({},r)),this.topicMap.set(r.topic,e),this.events.emit(lt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=Ie("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(lt.deleted,ui(vr({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(lt.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(lt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=Ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);Pd(r)&&this.onBatchSubscribe(r.map((n,i)=>ui(vr({},e[i]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Wt.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(st.connect,async()=>{await this.onConnect()}),this.relayer.on(st.disconnect,()=>{this.onDisconnect()}),this.events.on(lt.created,async e=>{const r=lt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(lt.deleted,async e=>{const r=lt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Ie("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var Hg=Object.defineProperty,fa=Object.getOwnPropertySymbols,Gg=Object.prototype.hasOwnProperty,Vg=Object.prototype.propertyIsEnumerable,ha=(t,e,r)=>e in t?Hg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Wg=(t,e)=>{for(var r in e||(e={}))Gg.call(e,r)&&ha(t,r,e[r]);if(fa)for(var r of fa(e))Vg.call(e,r)&&ha(t,r,e[r]);return t};class la extends Vu{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ht.exports.EventEmitter,this.name=So,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(st.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(st.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Et.payload,this.onPayloadHandler),this.provider.on(Et.connect,this.onConnectHandler),this.provider.on(Et.disconnect,this.onDisconnectHandler),this.provider.on(Et.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):Se.pino(Se.getDefaultLoggerOptions({level:e.logger||Do})),this.messages=new Ho(this.logger,e.core),this.subscriber=new ua(this,this.logger),this.publisher=new Mg(this,this.logger),this.relayUrl=e?.relayUrl||ti,this.projectId=e.projectId,this.bundleId=hd(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${ri}...`),await this.restartTransport(ri)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},xo)}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var n;this.isInitialized();let i=((n=this.subscriber.topicMap.get(e))==null?void 0:n[0])||"";if(i)return i;let s;const f=u=>{u.topic===e&&(this.subscriber.off(lt.created,f),s())};return await Promise.all([new Promise(u=>{s=u,this.subscriber.on(lt.created,f)}),new Promise(async u=>{i=await this.subscriber.subscribe(e,r),u()})]),i}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await gr(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(lt.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await gr(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(i){n(i);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(Et.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await uo())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ag(new Ug(_d({sdkVersion:To,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const i=this.messages.has(r,n);return i&&this.logger.debug(`Ignoring duplicate message: ${n}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),na(e)){if(!e.method.endsWith(Oo))return;const r=e.params,{topic:n,message:i,publishedAt:s}=r.data,f={topic:n,message:i,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Wg({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(e),await this.onMessageEvent(f)}else ci(e)&&this.events.emit(st.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(st.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Zo(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Et.payload,this.onPayloadHandler),this.provider.off(Et.connect,this.onConnectHandler),this.provider.off(Et.disconnect,this.onDisconnectHandler),this.provider.off(Et.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(st.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let e=await uo();Fd(async r=>{this.initialized&&e!==r&&(e=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(st.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ce.toMiliseconds(Io)))}isInitialized(){if(!this.initialized){const{message:e}=Ie("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var fi={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,f=9007199254740991,u="[object Arguments]",h="[object Array]",c="[object AsyncFunction]",l="[object Boolean]",p="[object Date]",_="[object Error]",b="[object Function]",O="[object GeneratorFunction]",A="[object Map]",N="[object Number]",G="[object Null]",m="[object Object]",R="[object Promise]",w="[object Proxy]",E="[object RegExp]",g="[object Set]",o="[object String]",d="[object Symbol]",L="[object Undefined]",P="[object WeakMap]",K="[object ArrayBuffer]",V="[object DataView]",J="[object Float32Array]",I="[object Float64Array]",C="[object Int8Array]",W="[object Int16Array]",F="[object Int32Array]",M="[object Uint8Array]",j="[object Uint8ClampedArray]",U="[object Uint16Array]",B="[object Uint32Array]",ee=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,k={};k[J]=k[I]=k[C]=k[W]=k[F]=k[M]=k[j]=k[U]=k[B]=!0,k[u]=k[h]=k[K]=k[l]=k[V]=k[p]=k[_]=k[b]=k[A]=k[N]=k[m]=k[E]=k[g]=k[o]=k[P]=!1;var Z=typeof ot=="object"&&ot&&ot.Object===Object&&ot,x=typeof self=="object"&&self&&self.Object===Object&&self,T=Z||x||Function("return this")(),D=e&&!e.nodeType&&e,a=D&&!0&&t&&!t.nodeType&&t,v=a&&a.exports===D,H=v&&Z.process,Y=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),he=Y&&Y.isTypedArray;function pe(y,S){for(var $=-1,X=y==null?0:y.length,xe=0,ie=[];++$<X;){var Ne=y[$];S(Ne,$,y)&&(ie[xe++]=Ne)}return ie}function de(y,S){for(var $=-1,X=S.length,xe=y.length;++$<X;)y[xe+$]=S[$];return y}function we(y,S){for(var $=-1,X=y==null?0:y.length;++$<X;)if(S(y[$],$,y))return!0;return!1}function Ue(y,S){for(var $=-1,X=Array(y);++$<y;)X[$]=S($);return X}function Ae(y){return function(S){return y(S)}}function _e(y,S){return y.has(S)}function ge(y,S){return y?.[S]}function le(y){var S=-1,$=Array(y.size);return y.forEach(function(X,xe){$[++S]=[xe,X]}),$}function ue(y,S){return function($){return y(S($))}}function ae(y){var S=-1,$=Array(y.size);return y.forEach(function(X){$[++S]=X}),$}var oe=Array.prototype,se=Function.prototype,te=Object.prototype,fe=T["__core-js_shared__"],ye=se.toString,ne=te.hasOwnProperty,be=function(){var y=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return y?"Symbol(src)_1."+y:""}(),ve=te.toString,me=RegExp("^"+ye.call(ne).replace(ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=v?T.Buffer:void 0,Ee=T.Symbol,bt=T.Uint8Array,mt=te.propertyIsEnumerable,Rt=oe.splice,ut=Ee?Ee.toStringTag:void 0,Bt=Object.getOwnPropertySymbols,wr=De?De.isBuffer:void 0,Qr=ue(Object.keys,Object),Me=er(T,"DataView"),Pe=er(T,"Map"),$e=er(T,"Promise"),je=er(T,"Set"),Fe=er(T,"WeakMap"),Le=er(Object,"create"),He=Kt(Me),Ge=Kt(Pe),Ve=Kt($e),We=Kt(je),Ye=Kt(Fe),ze=Ee?Ee.prototype:void 0,Be=ze?ze.valueOf:void 0;function Re(y){var S=-1,$=y==null?0:y.length;for(this.clear();++S<$;){var X=y[S];this.set(X[0],X[1])}}function qe(){this.__data__=Le?Le(null):{},this.size=0}function ke(y){var S=this.has(y)&&delete this.__data__[y];return this.size-=S?1:0,S}function t0(y){var S=this.__data__;if(Le){var $=S[y];return $===n?void 0:$}return ne.call(S,y)?S[y]:void 0}function r0(y){var S=this.__data__;return Le?S[y]!==void 0:ne.call(S,y)}function n0(y,S){var $=this.__data__;return this.size+=this.has(y)?0:1,$[y]=Le&&S===void 0?n:S,this}Re.prototype.clear=qe,Re.prototype.delete=ke,Re.prototype.get=t0,Re.prototype.has=r0,Re.prototype.set=n0;function It(y){var S=-1,$=y==null?0:y.length;for(this.clear();++S<$;){var X=y[S];this.set(X[0],X[1])}}function i0(){this.__data__=[],this.size=0}function s0(y){var S=this.__data__,$=en(S,y);if($<0)return!1;var X=S.length-1;return $==X?S.pop():Rt.call(S,$,1),--this.size,!0}function o0(y){var S=this.__data__,$=en(S,y);return $<0?void 0:S[$][1]}function a0(y){return en(this.__data__,y)>-1}function c0(y,S){var $=this.__data__,X=en($,y);return X<0?(++this.size,$.push([y,S])):$[X][1]=S,this}It.prototype.clear=i0,It.prototype.delete=s0,It.prototype.get=o0,It.prototype.has=a0,It.prototype.set=c0;function zt(y){var S=-1,$=y==null?0:y.length;for(this.clear();++S<$;){var X=y[S];this.set(X[0],X[1])}}function u0(){this.size=0,this.__data__={hash:new Re,map:new(Pe||It),string:new Re}}function f0(y){var S=tn(this,y).delete(y);return this.size-=S?1:0,S}function h0(y){return tn(this,y).get(y)}function l0(y){return tn(this,y).has(y)}function d0(y,S){var $=tn(this,y),X=$.size;return $.set(y,S),this.size+=$.size==X?0:1,this}zt.prototype.clear=u0,zt.prototype.delete=f0,zt.prototype.get=h0,zt.prototype.has=l0,zt.prototype.set=d0;function Zr(y){var S=-1,$=y==null?0:y.length;for(this.__data__=new zt;++S<$;)this.add(y[S])}function g0(y){return this.__data__.set(y,n),this}function y0(y){return this.__data__.has(y)}Zr.prototype.add=Zr.prototype.push=g0,Zr.prototype.has=y0;function Ct(y){var S=this.__data__=new It(y);this.size=S.size}function _0(){this.__data__=new It,this.size=0}function p0(y){var S=this.__data__,$=S.delete(y);return this.size=S.size,$}function b0(y){return this.__data__.get(y)}function v0(y){return this.__data__.has(y)}function w0(y,S){var $=this.__data__;if($ instanceof It){var X=$.__data__;if(!Pe||X.length<r-1)return X.push([y,S]),this.size=++$.size,this;$=this.__data__=new zt(X)}return $.set(y,S),this.size=$.size,this}Ct.prototype.clear=_0,Ct.prototype.delete=p0,Ct.prototype.get=b0,Ct.prototype.has=v0,Ct.prototype.set=w0;function E0(y,S){var $=rn(y),X=!$&&M0(y),xe=!$&&!X&&hi(y),ie=!$&&!X&&!xe&&Pa(y),Ne=$||X||xe||ie,Xe=Ne?Ue(y.length,String):[],Qe=Xe.length;for(var Ce in y)(S||ne.call(y,Ce))&&!(Ne&&(Ce=="length"||xe&&(Ce=="offset"||Ce=="parent")||ie&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||A0(Ce,Qe)))&&Xe.push(Ce);return Xe}function en(y,S){for(var $=y.length;$--;)if(xa(y[$][0],S))return $;return-1}function m0(y,S,$){var X=S(y);return rn(y)?X:de(X,$(y))}function Er(y){return y==null?y===void 0?L:G:ut&&ut in Object(y)?R0(y):U0(y)}function Sa(y){return mr(y)&&Er(y)==u}function Oa(y,S,$,X,xe){return y===S?!0:y==null||S==null||!mr(y)&&!mr(S)?y!==y&&S!==S:D0(y,S,$,X,Oa,xe)}function D0(y,S,$,X,xe,ie){var Ne=rn(y),Xe=rn(S),Qe=Ne?h:At(y),Ce=Xe?h:At(S);Qe=Qe==u?m:Qe,Ce=Ce==u?m:Ce;var ft=Qe==m,vt=Ce==m,et=Qe==Ce;if(et&&hi(y)){if(!hi(S))return!1;Ne=!0,ft=!1}if(et&&!ft)return ie||(ie=new Ct),Ne||Pa(y)?Ia(y,S,$,X,xe,ie):T0(y,S,Qe,$,X,xe,ie);if(!($&i)){var gt=ft&&ne.call(y,"__wrapped__"),yt=vt&&ne.call(S,"__wrapped__");if(gt||yt){var Pt=gt?y.value():y,Tt=yt?S.value():S;return ie||(ie=new Ct),xe(Pt,Tt,$,X,ie)}}return et?(ie||(ie=new Ct),x0(y,S,$,X,xe,ie)):!1}function S0(y){if(!Aa(y)||L0(y))return!1;var S=Ra(y)?me:z;return S.test(Kt(y))}function O0(y){return mr(y)&&Ca(y.length)&&!!k[Er(y)]}function I0(y){if(!N0(y))return Qr(y);var S=[];for(var $ in Object(y))ne.call(y,$)&&$!="constructor"&&S.push($);return S}function Ia(y,S,$,X,xe,ie){var Ne=$&i,Xe=y.length,Qe=S.length;if(Xe!=Qe&&!(Ne&&Qe>Xe))return!1;var Ce=ie.get(y);if(Ce&&ie.get(S))return Ce==S;var ft=-1,vt=!0,et=$&s?new Zr:void 0;for(ie.set(y,S),ie.set(S,y);++ft<Xe;){var gt=y[ft],yt=S[ft];if(X)var Pt=Ne?X(yt,gt,ft,S,y,ie):X(gt,yt,ft,y,S,ie);if(Pt!==void 0){if(Pt)continue;vt=!1;break}if(et){if(!we(S,function(Tt,Ht){if(!_e(et,Ht)&&(gt===Tt||xe(gt,Tt,$,X,ie)))return et.push(Ht)})){vt=!1;break}}else if(!(gt===yt||xe(gt,yt,$,X,ie))){vt=!1;break}}return ie.delete(y),ie.delete(S),vt}function T0(y,S,$,X,xe,ie,Ne){switch($){case V:if(y.byteLength!=S.byteLength||y.byteOffset!=S.byteOffset)return!1;y=y.buffer,S=S.buffer;case K:return!(y.byteLength!=S.byteLength||!ie(new bt(y),new bt(S)));case l:case p:case N:return xa(+y,+S);case _:return y.name==S.name&&y.message==S.message;case E:case o:return y==S+"";case A:var Xe=le;case g:var Qe=X&i;if(Xe||(Xe=ae),y.size!=S.size&&!Qe)return!1;var Ce=Ne.get(y);if(Ce)return Ce==S;X|=s,Ne.set(y,S);var ft=Ia(Xe(y),Xe(S),X,xe,ie,Ne);return Ne.delete(y),ft;case d:if(Be)return Be.call(y)==Be.call(S)}return!1}function x0(y,S,$,X,xe,ie){var Ne=$&i,Xe=Ta(y),Qe=Xe.length,Ce=Ta(S),ft=Ce.length;if(Qe!=ft&&!Ne)return!1;for(var vt=Qe;vt--;){var et=Xe[vt];if(!(Ne?et in S:ne.call(S,et)))return!1}var gt=ie.get(y);if(gt&&ie.get(S))return gt==S;var yt=!0;ie.set(y,S),ie.set(S,y);for(var Pt=Ne;++vt<Qe;){et=Xe[vt];var Tt=y[et],Ht=S[et];if(X)var La=Ne?X(Ht,Tt,et,S,y,ie):X(Tt,Ht,et,y,S,ie);if(!(La===void 0?Tt===Ht||xe(Tt,Ht,$,X,ie):La)){yt=!1;break}Pt||(Pt=et=="constructor")}if(yt&&!Pt){var nn=y.constructor,sn=S.constructor;nn!=sn&&"constructor"in y&&"constructor"in S&&!(typeof nn=="function"&&nn instanceof nn&&typeof sn=="function"&&sn instanceof sn)&&(yt=!1)}return ie.delete(y),ie.delete(S),yt}function Ta(y){return m0(y,F0,C0)}function tn(y,S){var $=y.__data__;return P0(S)?$[typeof S=="string"?"string":"hash"]:$.map}function er(y,S){var $=ge(y,S);return S0($)?$:void 0}function R0(y){var S=ne.call(y,ut),$=y[ut];try{y[ut]=void 0;var X=!0}catch{}var xe=ve.call(y);return X&&(S?y[ut]=$:delete y[ut]),xe}var C0=Bt?function(y){return y==null?[]:(y=Object(y),pe(Bt(y),function(S){return mt.call(y,S)}))}:B0,At=Er;(Me&&At(new Me(new ArrayBuffer(1)))!=V||Pe&&At(new Pe)!=A||$e&&At($e.resolve())!=R||je&&At(new je)!=g||Fe&&At(new Fe)!=P)&&(At=function(y){var S=Er(y),$=S==m?y.constructor:void 0,X=$?Kt($):"";if(X)switch(X){case He:return V;case Ge:return A;case Ve:return R;case We:return g;case Ye:return P}return S});function A0(y,S){return S=S??f,!!S&&(typeof y=="number"||Q.test(y))&&y>-1&&y%1==0&&y<S}function P0(y){var S=typeof y;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?y!=="__proto__":y===null}function L0(y){return!!be&&be in y}function N0(y){var S=y&&y.constructor,$=typeof S=="function"&&S.prototype||te;return y===$}function U0(y){return ve.call(y)}function Kt(y){if(y!=null){try{return ye.call(y)}catch{}try{return y+""}catch{}}return""}function xa(y,S){return y===S||y!==y&&S!==S}var M0=Sa(function(){return arguments}())?Sa:function(y){return mr(y)&&ne.call(y,"callee")&&!mt.call(y,"callee")},rn=Array.isArray;function $0(y){return y!=null&&Ca(y.length)&&!Ra(y)}var hi=wr||z0;function j0(y,S){return Oa(y,S)}function Ra(y){if(!Aa(y))return!1;var S=Er(y);return S==b||S==O||S==c||S==w}function Ca(y){return typeof y=="number"&&y>-1&&y%1==0&&y<=f}function Aa(y){var S=typeof y;return y!=null&&(S=="object"||S=="function")}function mr(y){return y!=null&&typeof y=="object"}var Pa=he?Ae(he):O0;function F0(y){return $0(y)?E0(y):I0(y)}function B0(){return[]}function z0(){return!1}t.exports=j0})(fi,fi.exports);var Yg=fi.exports,qg=Object.defineProperty,da=Object.getOwnPropertySymbols,kg=Object.prototype.hasOwnProperty,Xg=Object.prototype.propertyIsEnumerable,ga=(t,e,r)=>e in t?qg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ya=(t,e)=>{for(var r in e||(e={}))kg.call(e,r)&&ga(t,r,e[r]);if(da)for(var r of da(e))Xg.call(e,r)&&ga(t,r,e[r]);return t};class _a extends Wu{constructor(e,r,n,i=Dt,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=Ro,this.cached=[],this.initialized=!1,this.storagePrefix=Dt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!Wr(f)?this.map.set(this.getKey(f),f):Nd(f)?this.map.set(f.id,f):Ud(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,u)=>{this.isInitialized(),this.map.has(f)?await this.update(f,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:u}),this.map.set(f,u),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(u=>Object.keys(f).every(h=>Yg(u[h],f[h]))):this.values),this.update=async(f,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:u});const h=ya(ya({},this.getData(f)),u);this.map.set(f,h),await this.persist()},this.delete=async(f,u)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:u}),this.map.delete(f),await this.persist())},this.logger=Se.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=Ie("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=Ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Ie("NOT_INITIALIZED",this.name);throw new Error(e)}}}class pa{constructor(e,r){this.core=e,this.logger=r,this.name=No,this.version=Uo,this.events=new ht.exports,this.initialized=!1,this.storagePrefix=Dt,this.ignoredPayloadTypes=[Xt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Yn(),i=await this.core.crypto.setSymKey(n),s=Gr(ce.FIVE_MINUTES),f={protocol:mo},u={topic:i,expiry:s,relay:f,active:!1},h=Rd({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:f});return await this.pairings.set(i,u),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:h}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:f}=ao(n.uri);let u;if(this.pairings.keys.includes(i)&&(u=this.pairings.get(i),u.active))throw new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);const h=Gr(ce.FIVE_MINUTES),c={topic:i,relay:f,expiry:h,active:!1};return await this.pairings.set(i,c),this.core.expirer.set(i,h),n.activatePairing&&await this.activate({topic:i}),this.events.emit(_r.create,c),this.core.crypto.keychain.has(i)||(await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:f})),c},this.activate=async({topic:n})=>{this.isInitialized();const i=Gr(ce.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:f,resolve:u,reject:h}=pd();this.events.once(Xn("pairing_ping",s),({error:c})=>{c?h(c):u()}),await f()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",yr("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const f=ai(i,s),u=await this.core.crypto.encode(n,f),h=Qt[i].req;return this.core.history.set(n,f),this.core.relayer.publish(n,u,h),f.id},this.sendResult=async(n,i,s)=>{const f=Zo(n,s),u=await this.core.crypto.encode(i,f),h=await this.core.history.get(i,n),c=Qt[h.request.method].res;await this.core.relayer.publish(i,u,c),await this.core.history.resolve(f)},this.sendError=async(n,i,s)=>{const f=ea(n,s),u=await this.core.crypto.encode(i,f),h=await this.core.history.get(i,n),c=Qt[h.request.method]?Qt[h.request.method].res:Qt.unregistered_method.res;await this.core.relayer.publish(i,u,c),await this.core.history.resolve(f)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,yr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>io(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,f=(await this.core.history.get(i,s.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit(_r.ping,{id:s,topic:n})}catch(f){await this.sendError(s,n,f),this.logger.error(f)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{ia(i)?this.events.emit(Xn("pairing_ping",s),{}):Xr(i)&&this.events.emit(Xn("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(_r.delete,{id:s,topic:n})}catch(f){await this.sendError(s,n,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:f}=i;try{if(this.registeredMethods.includes(f))return;const u=yr("WC_METHOD_UNSUPPORTED",f);await this.sendError(s,n,u),this.logger.error(u)}catch(u){await this.sendError(s,n,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(yr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var i;if(!Qn(n)){const{message:f}=Ie("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(f)}if(!Ld(n.uri)){const{message:f}=Ie("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(f)}const s=ao(n.uri);if(!((i=s?.relay)!=null&&i.protocol)){const{message:f}=Ie("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(s!=null&&s.symKey)){const{message:f}=Ie("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async n=>{if(!Qn(n)){const{message:s}=Ie("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!Qn(n)){const{message:s}=Ie("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!co(n,!1)){const{message:i}=Ie("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=Ie("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(io(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=Ie("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.pairings=new _a(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Ie("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(st.message,async e=>{const{topic:r,message:n}=e;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);try{na(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):ci(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:r,payload:i}),this.core.history.delete(r,i.id))}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(dt.expired,async e=>{const{topic:r}=wd(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(_r.expire,{topic:r}))})}}class ba extends Ku{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ht.exports.EventEmitter,this.name=Mo,this.version=$o,this.cached=[],this.initialized=!1,this.storagePrefix=Dt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const f={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s,expiry:Gr(ce.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(pt.created,f)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=Xr(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(pt.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(pt.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:ai(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=Ie("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(pt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=Ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(pt.created,e=>{const r=pt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(pt.updated,e=>{const r=pt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(pt.deleted,e=>{const r=pt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(Wt.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ce.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Ie("NOT_INITIALIZED",this.name);throw new Error(e)}}}class va extends qu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ht.exports.EventEmitter,this.name=jo,this.version=Fo,this.cached=[],this.initialized=!1,this.storagePrefix=Dt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),f={target:s,expiry:i};this.expirations.set(s,f),this.checkExpiry(s,f),this.events.emit(dt.created,{target:s,expiration:f})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(dt.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return bd(e);if(typeof e=="number")return vd(e);const{message:r}=Ie("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(dt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=Ie("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=Ie("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;ce.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(dt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Wt.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(dt.created,e=>{const r=dt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(dt.expired,e=>{const r=dt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(dt.deleted,e=>{const r=dt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Ie("NOT_INITIALIZED",this.name);throw new Error(e)}}}class wa extends ku{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=qr,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||Jt()||!Kr())return;const i=this.getVerifyUrl(n?.verifyUrl);this.verifyUrl!==i&&this.removeIframe(),this.verifyUrl=i;try{await this.createIframe()}catch(s){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(s)}if(!this.initialized){this.removeIframe(),this.verifyUrl=kr;try{await this.createIframe()}catch(s){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(s),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const i=this.getVerifyUrl(n?.verifyUrl);let s;try{s=await this.fetchAttestation(n.attestationId,i)}catch(f){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${i}`),this.logger.info(f),s=await this.fetchAttestation(n.attestationId,kr)}return s},this.fetchAttestation=async(n,i)=>{this.logger.info(`resolving attestation: ${n} from url: ${i}`);const s=this.startAbortTimer(ce.ONE_SECOND*2),f=await fetch(`${i}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(s),f.status===200?await f.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var i;try{if(!this.iframe)return;(i=this.iframe.contentWindow)==null||i.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const i=s=>{s.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",i),n())};await Promise.race([new Promise(s=>{if(document.getElementById(qr))return s();window.addEventListener("message",i);const f=document.createElement("iframe");f.id=qr,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,n=s}),new Promise((s,f)=>setTimeout(()=>{window.removeEventListener("message",i),f("verify iframe load timeout")},ce.toMiliseconds(ce.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let i=n||Zt;return Bo.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Zt}`),i=Zt),i},this.logger=Se.generateChildLogger(r,this.name),this.verifyUrl=Zt,this.abortController=new AbortController,this.isDevEnv=kn()&&process.env.IS_VITEST}get context(){return Se.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ce.toMiliseconds(e))}}var Jg=Object.defineProperty,Ea=Object.getOwnPropertySymbols,Qg=Object.prototype.hasOwnProperty,Zg=Object.prototype.propertyIsEnumerable,ma=(t,e,r)=>e in t?Jg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Da=(t,e)=>{for(var r in e||(e={}))Qg.call(e,r)&&ma(t,r,e[r]);if(Ea)for(var r of Ea(e))Zg.call(e,r)&&ma(t,r,e[r]);return t};class Jr extends zu{constructor(e){super(e),this.protocol=Zn,this.version=fo,this.name=Yr,this.events=new ht.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||ti,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Se.pino(Se.getDefaultLoggerOptions({level:e?.logger||ho.logger}));this.logger=Se.generateChildLogger(r,this.name),this.heartbeat=new Wt.HeartBeat,this.crypto=new Ko(this,this.logger,e?.keychain),this.history=new ba(this,this.logger),this.expirer=new va(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new pc(Da(Da({},lo),e?.storageOptions)),this.relayer=new la({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new pa(this,this.logger),this.verify=new wa(this.projectId||"",this.logger)}static async init(e){const r=new Jr(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(Co,n),r}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const e0=Jr;q.CORE_CONTEXT=Yr,q.CORE_DEFAULT=ho,q.CORE_PROTOCOL=Zn,q.CORE_STORAGE_OPTIONS=lo,q.CORE_STORAGE_PREFIX=Dt,q.CORE_VERSION=fo,q.CRYPTO_CLIENT_SEED=ei,q.CRYPTO_CONTEXT=go,q.CRYPTO_JWT_TTL=yo,q.Core=e0,q.Crypto=Ko,q.EXPIRER_CONTEXT=jo,q.EXPIRER_DEFAULT_TTL=Vd,q.EXPIRER_EVENTS=dt,q.EXPIRER_STORAGE_VERSION=Fo,q.Expirer=va,q.HISTORY_CONTEXT=Mo,q.HISTORY_EVENTS=pt,q.HISTORY_STORAGE_VERSION=$o,q.JsonRpcHistory=ba,q.KEYCHAIN_CONTEXT=_o,q.KEYCHAIN_STORAGE_VERSION=po,q.KeyChain=zo,q.MESSAGES_CONTEXT=bo,q.MESSAGES_STORAGE_VERSION=vo,q.MessageTracker=Ho,q.PAIRING_CONTEXT=No,q.PAIRING_DEFAULT_TTL=Gd,q.PAIRING_EVENTS=_r,q.PAIRING_RPC_OPTS=Qt,q.PAIRING_STORAGE_VERSION=Uo,q.PENDING_SUB_RESOLUTION_TIMEOUT=Lo,q.PUBLISHER_CONTEXT=Eo,q.PUBLISHER_DEFAULT_TTL=wo,q.Pairing=pa,q.RELAYER_CONTEXT=So,q.RELAYER_DEFAULT_LOGGER=Do,q.RELAYER_DEFAULT_PROTOCOL=mo,q.RELAYER_DEFAULT_RELAY_URL=ti,q.RELAYER_EVENTS=st,q.RELAYER_FAILOVER_RELAY_URL=ri,q.RELAYER_PROVIDER_EVENTS=Et,q.RELAYER_RECONNECT_TIMEOUT=Io,q.RELAYER_SDK_VERSION=To,q.RELAYER_STORAGE_OPTIONS=Kd,q.RELAYER_SUBSCRIBER_SUFFIX=Oo,q.RELAYER_TRANSPORT_CUTOFF=xo,q.Relayer=la,q.STORE_STORAGE_VERSION=Ro,q.SUBSCRIBER_CONTEXT=Ao,q.SUBSCRIBER_DEFAULT_TTL=Hd,q.SUBSCRIBER_EVENTS=lt,q.SUBSCRIBER_STORAGE_VERSION=Po,q.Store=_a,q.Subscriber=ua,q.TRUSTED_VERIFY_URLS=Bo,q.VERIFY_CONTEXT=qr,q.VERIFY_FALLBACK_SERVER=kr,q.VERIFY_SERVER=Zt,q.Verify=wa,q.WALLETCONNECT_CLIENT_ID=Co,q.default=Jr,Object.defineProperty(q,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
